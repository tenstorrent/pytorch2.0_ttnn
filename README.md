[comment]: <> (This README.md was generated by tools/collect_metrics.py.)
[comment]: <> (Please modify docs/README.md.in and/or collect_metrics.py to make permanent changes.)

# PyTorch 2.0 TTNN Compiler
This project allows to run PyTorch code on [Tenstorrent](https://tenstorrent.com/) hardware.

## Supported Models

The table below summarizes the results of running various ML models through our TTNN compiler. For each model, we track whether the run was successful, the number of operations before and after conversion, the number of `to_device` and `from_device` operations, performance metrics, and accuracy.

| Model                                                                                                | Status   | Torch Ops Before (Unique Ops)   | Torch Ops Remain (Unique Ops)   | To/From Device Ops   |   Original Run Time (ms) | Compiled Run Time for 5th Iteration (ms)   | Accuracy (%)   |
|:-----------------------------------------------------------------------------------------------------|:---------|:--------------------------------|:--------------------------------|:---------------------|-------------------------:|:-------------------------------------------|:---------------|
| [Autoencoder (linear)](<docs/models/Autoencoder (linear)>)                                           | ✅       | 22 (3)                          | 0 (0)                           | 0                    |            2938.46       | 22.44                                      | 100.0          |
| [BERT](<docs/models/BERT>)                                                                           | ✅       | 1393 (21)                       | 0 (0)                           | 0                    |          103372          | 4101.04                                    | 99.69          |
| [Bloom](<docs/models/Bloom>)                                                                         | ✅       | 1403 (26)                       | 0 (0)                           | 0                    |           95473.9        | 7743.04                                    | 43.3           |
| [DPR](<docs/models/DPR>)                                                                             | ✅       | 720 (22)                        | 0 (0)                           | 3                    |           11624.2        | 1128.36                                    | 99.24          |
| [Llama](<docs/models/Llama>)                                                                         | ✅       | 40 (11)                         | 0 (0)                           | 2                    |          670770          | 209586.32                                  | 100.0          |
| [MLPMixer](<docs/models/MLPMixer>)                                                                   | ✅       | 253 (11)                        | 0 (0)                           | 0                    |            5663.37       | 711.27                                     | 99.96          |
| [Mnist](<docs/models/Mnist>)                                                                         | ✅       | 14 (8)                          | 0 (0)                           | 1                    |            3877.65       | 29.77                                      | 98.39          |
| [MobileNetV2](<docs/models/MobileNetV2>)                                                             | ✅       | 154 (9)                         | 0 (0)                           | 0                    |            1022.18       | 2915.53                                    | 99.84          |
| [OpenPose V2](<docs/models/OpenPose V2>)                                                             | ✅       | 155 (7)                         | 0 (0)                           | 6                    |            3035.68       | 2113.25                                    | 91.05          |
| [Perceiver IO](<docs/models/Perceiver IO>)                                                           | ✅       | 1531 (20)                       | 0 (0)                           | 1                    |           46032.2        | 4196.49                                    | 99.95          |
| [ResNet18](<docs/models/ResNet18>)                                                                   | ✅       | 70 (9)                          | 0 (0)                           | 1                    |            1821.15       | 799.72                                     | 98.82          |
| [ResNet50](<docs/models/ResNet50>)                                                                   | ✅       | 176 (9)                         | 0 (0)                           | 1                    |            4597.57       | 2697.41                                    | 99.15          |
| [RoBERTa](<docs/models/RoBERTa>)                                                                     | ✅       | 719 (21)                        | 0 (0)                           | 3                    |           18857.1        | 3915.1                                     | 98.25          |
| [SqueezeBERT](<docs/models/SqueezeBERT>)                                                             | ✅       | 16 (9)                          | 0 (0)                           | 3                    |            3726.41       | 225.82                                     | 100.0          |
| [U-Net](<docs/models/U-Net>)                                                                         | ✅       | 68 (6)                          | 0 (0)                           | 12                   |           62025.9        | 1051.15                                    | 100.0          |
| [Unet-brain](<docs/models/Unet-brain>)                                                               | ✅       | 68 (6)                          | 0 (0)                           | 12                   |           57848          | 1110.65                                    | N/A            |
| [Unet-carvana](<docs/models/Unet-carvana>)                                                           | ✅       | 67 (5)                          | 0 (0)                           | 12                   |           83802.9        | 2879.88                                    | 99.69          |
| [YOLOv5](<docs/models/YOLOv5>)                                                                       | ✅       | 3 (3)                           | 0 (0)                           | 0                    |           25385.9        | 17251.67                                   | 100.0          |
| [albert/albert-base-v2](<docs/models/albert/albert-base-v2>)                                         | ✅       | 791 (21)                        | 0 (0)                           | 3                    |            3001.75       | 530.62                                     | 69.04          |
| [albert/albert-base-v2-classification](<docs/models/albert/albert-base-v2-classification>)           | ✅       | 779 (21)                        | 0 (0)                           | 3                    |            2064.77       | 413.58                                     | 99.94          |
| [albert/albert-large-v2](<docs/models/albert/albert-large-v2>)                                       | ✅       | 1547 (21)                       | 0 (0)                           | 3                    |           10778.2        | 945.95                                     | 23.63          |
| [albert/albert-xlarge-v2](<docs/models/albert/albert-xlarge-v2>)                                     | ✅       | 1547 (21)                       | 0 (0)                           | 3                    |           13482.7        | 1539.44                                    | 53.42          |
| [distilbert-base-uncased](<docs/models/distilbert-base-uncased>)                                     | ✅       | 361 (16)                        | 0 (0)                           | 2                    |            7510.13       | 520.88                                     | 99.81          |
| [dla34.in1k](<docs/models/dla34.in1k>)                                                               | ✅       | 135 (9)                         | 0 (0)                           | 23                   |            3829.63       | 1587.35                                    | 99.59          |
| [ghostnet_100.in1k](<docs/models/ghostnet_100.in1k>)                                                 | ✅       | 515 (14)                        | 0 (0)                           | 64                   |            1508.19       | 2623.06                                    | 99.74          |
| [mobilenet_v2](<docs/models/mobilenet_v2>)                                                           | ✅       | 154 (9)                         | 0 (0)                           | 0                    |            4605.95       | 3117.72                                    | 99.84          |
| [mobilenet_v3_large](<docs/models/mobilenet_v3_large>)                                               | ✅       | 188 (11)                        | 0 (0)                           | 0                    |            1082.5        | 3405.88                                    | 99.76          |
| [mobilenet_v3_small](<docs/models/mobilenet_v3_small>)                                               | ✅       | 158 (11)                        | 0 (0)                           | 0                    |            1099.94       | 1738.07                                    | 99.54          |
| [mobilenetv1_100.ra4_e3600_r224_in1k](<docs/models/mobilenetv1_100.ra4_e3600_r224_in1k>)             | ✅       | 85 (7)                          | 0 (0)                           | 0                    |            1425.12       | 2577.17                                    | -6.46          |
| [regnet_x_16gf](<docs/models/regnet_x_16gf>)                                                         | ✅       | 235 (8)                         | 0 (0)                           | 0                    |           14728.9        | 12496.58                                   | 1.01           |
| [regnet_x_1_6gf](<docs/models/regnet_x_1_6gf>)                                                       | ✅       | 195 (8)                         | 0 (0)                           | 0                    |            2226.53       | 4226.72                                    | 99.82          |
| [regnet_x_32gf](<docs/models/regnet_x_32gf>)                                                         | ✅       | 245 (8)                         | 0 (0)                           | 0                    |           28781.5        | 29615.13                                   | 3.94           |
| [regnet_x_3_2gf](<docs/models/regnet_x_3_2gf>)                                                       | ✅       | 265 (8)                         | 0 (0)                           | 0                    |            3989.67       | 6100.13                                    | 99.81          |
| [regnet_x_400mf](<docs/models/regnet_x_400mf>)                                                       | ✅       | 235 (8)                         | 0 (0)                           | 0                    |             804.42       | 2388.15                                    | 99.87          |
| [regnet_x_800mf](<docs/models/regnet_x_800mf>)                                                       | ✅       | 175 (8)                         | 0 (0)                           | 0                    |            1552.11       | 2686.14                                    | 99.86          |
| [regnet_x_8gf](<docs/models/regnet_x_8gf>)                                                           | ✅       | 245 (8)                         | 0 (0)                           | 0                    |            9136.14       | 12325.92                                   | 99.7           |
| [regnet_y_1_6gf](<docs/models/regnet_y_1_6gf>)                                                       | ✅       | 447 (10)                        | 0 (0)                           | 0                    |            1798.21       | 4307.06                                    | 99.84          |
| [regnet_y_32gf](<docs/models/regnet_y_32gf>)                                                         | ✅       | 335 (10)                        | 0 (0)                           | 0                    |           30720          | 29371.62                                   | 99.9           |
| [regnet_y_3_2gf](<docs/models/regnet_y_3_2gf>)                                                       | ✅       | 351 (10)                        | 0 (0)                           | 0                    |            3089.69       | 5150.1                                     | 99.9           |
| [regnet_y_400mf](<docs/models/regnet_y_400mf>)                                                       | ✅       | 271 (10)                        | 0 (0)                           | 0                    |            1762.75       | 2252.28                                    | 99.68          |
| [regnet_y_800mf](<docs/models/regnet_y_800mf>)                                                       | ✅       | 239 (10)                        | 0 (0)                           | 0                    |            1114.52       | 2231.7                                     | 99.85          |
| [regnet_y_8gf](<docs/models/regnet_y_8gf>)                                                           | ✅       | 287 (10)                        | 0 (0)                           | 0                    |            7564.98       | 7205.77                                    | 99.95          |
| [resnet101](<docs/models/resnet101>)                                                                 | ✅       | 346 (9)                         | 0 (0)                           | 1                    |            7520.67       | 5039.79                                    | 99.48          |
| [resnet152](<docs/models/resnet152>)                                                                 | ✅       | 516 (9)                         | 0 (0)                           | 1                    |           13743.7        | 6917.44                                    | 99.49          |
| [resnet18](<docs/models/resnet18>)                                                                   | ✅       | 70 (9)                          | 0 (0)                           | 1                    |            2244.69       | 924.17                                     | 99.61          |
| [resnet34](<docs/models/resnet34>)                                                                   | ✅       | 126 (9)                         | 0 (0)                           | 1                    |            4089.39       | 1580.66                                    | 99.07          |
| [resnet50](<docs/models/resnet50>)                                                                   | ✅       | 176 (9)                         | 0 (0)                           | 1                    |            4364.04       | 2692.25                                    | 99.15          |
| [resnext101_32x8d](<docs/models/resnext101_32x8d>)                                                   | ✅       | 346 (9)                         | 0 (0)                           | 1                    |           18925          | 25330.0                                    | 99.91          |
| [resnext101_64x4d](<docs/models/resnext101_64x4d>)                                                   | ✅       | 346 (9)                         | 0 (0)                           | 1                    |           17792.5        | 23819.89                                   | 99.87          |
| [resnext50_32x4d](<docs/models/resnext50_32x4d>)                                                     | ✅       | 176 (9)                         | 0 (0)                           | 1                    |            5116.34       | 5242.38                                    | 99.88          |
| [textattack/albert-base-v2-imdb](<docs/models/textattack/albert-base-v2-imdb>)                       | ✅       | 782 (22)                        | 0 (0)                           | 3                    |            2282.75       | 410.67                                     | 100.0          |
| [tf_efficientnet_lite0.in1k](<docs/models/tf_efficientnet_lite0.in1k>)                               | ✅       | 149 (9)                         | 0 (0)                           | 5                    |            1140.15       | 6563.26                                    | 99.76          |
| [tf_efficientnet_lite1.in1k](<docs/models/tf_efficientnet_lite1.in1k>)                               | ✅       | 194 (9)                         | 0 (0)                           | 5                    |            1554.71       | 8665.72                                    | 99.78          |
| [tf_efficientnet_lite2.in1k](<docs/models/tf_efficientnet_lite2.in1k>)                               | ✅       | 194 (9)                         | 0 (0)                           | 5                    |            2683.79       | 11287.47                                   | 99.72          |
| [twmkn9/albert-base-v2-squad2](<docs/models/twmkn9/albert-base-v2-squad2>)                           | ✅       | 783 (23)                        | 0 (0)                           | 3                    |            2648.7        | 435.57                                     | 98.47          |
| [vgg11](<docs/models/vgg11>)                                                                         | ✅       | 33 (8)                          | 0 (0)                           | 5                    |           10242.1        | 1466.09                                    | 99.8           |
| [vgg11_bn](<docs/models/vgg11_bn>)                                                                   | ✅       | 41 (9)                          | 0 (0)                           | 5                    |            9598.6        | 1522.1                                     | 99.3           |
| [vgg13](<docs/models/vgg13>)                                                                         | ✅       | 37 (8)                          | 0 (0)                           | 5                    |           16695.1        | 1585.35                                    | 99.88          |
| [vgg13_bn](<docs/models/vgg13_bn>)                                                                   | ✅       | 47 (9)                          | 0 (0)                           | 5                    |           16608.4        | 1706.05                                    | 99.05          |
| [vgg16](<docs/models/vgg16>)                                                                         | ✅       | 43 (8)                          | 0 (0)                           | 5                    |           24892          | 2032.45                                    | 99.7           |
| [vgg16_bn](<docs/models/vgg16_bn>)                                                                   | ✅       | 56 (9)                          | 0 (0)                           | 5                    |           20941.7        | 2287.53                                    | 98.21          |
| [vgg19](<docs/models/vgg19>)                                                                         | ✅       | 49 (8)                          | 0 (0)                           | 5                    |           29793.8        | 2334.77                                    | 99.52          |
| [vgg19_bn](<docs/models/vgg19_bn>)                                                                   | ✅       | 65 (9)                          | 0 (0)                           | 5                    |           29707.3        | 2541.21                                    | 97.44          |
| [wide_resnet101_2](<docs/models/wide_resnet101_2>)                                                   | ✅       | 346 (9)                         | 0 (0)                           | 1                    |           23034.5        | 7705.67                                    | 99.38          |
| [wide_resnet50_2](<docs/models/wide_resnet50_2>)                                                     | ✅       | 176 (9)                         | 0 (0)                           | 1                    |           11388.1        | 4106.66                                    | 99.31          |
| [xception71.tf_in1k](<docs/models/xception71.tf_in1k>)                                               | ✅       | 393 (9)                         | 0 (0)                           | 0                    |           20001.7        | 28812.79                                   | 99.78          |
| [Autoencoder (conv)](<docs/models/Autoencoder (conv)>)                                               | 🚧       | 9 (3)                           | 1 (1)                           | 1                    |            2796.94       | 19.07                                      | 100.0          |
| [Autoencoder (conv)-train](<docs/models/Autoencoder (conv)-train>)                                   | 🚧       | 24 (7)                          | 11 (4)                          | 0                    |            4206.05       | 18.4                                       | 100.0          |
| [Autoencoder (linear)-train](<docs/models/Autoencoder (linear)-train>)                               | 🚧       | 104 (8)                         | 14 (2)                          | 0                    |            4548.69       | 64.09                                      | 100.0          |
| [CLIP](<docs/models/CLIP>)                                                                           | 🚧       | 1395 (29)                       | 7 (6)                           | 5                    |            6360.57       | 2211.12                                    | 94.26          |
| [DETR](<docs/models/DETR>)                                                                           | 🚧       | 1646 (35)                       | 24 (3)                          | 3                    |          112593          | 24060.38                                   | 46.6           |
| [Falcon](<docs/models/Falcon>)                                                                       | 🚧       | 71 (6)                          | 1 (1)                           | 3                    |          538469          | 47864.3                                    | 100.0          |
| [GLPN-KITTI](<docs/models/GLPN-KITTI>)                                                               | 🚧       | 2959 (26)                       | 22 (2)                          | 6                    |          143586          | 115085.88                                  | 99.75          |
| [GPT-2](<docs/models/GPT-2>)                                                                         | 🚧       | 745 (29)                        | 15 (4)                          | 2                    |           21881.9        | 999.39                                     | 100.0          |
| [Hand Landmark](<docs/models/Hand Landmark>)                                                         | 🚧       | N/A                             | N/A                             | N/A                  |            8312.04       | 76.83                                      | N/A            |
| [HardNet](<docs/models/HardNet>)                                                                     | 🚧       | 245 (10)                        | 2 (1)                           | 122                  |            4750.88       | 2213.72                                    | 98.59          |
| [HardNet-train](<docs/models/HardNet-train>)                                                         | 🚧       | 867 (21)                        | 480 (11)                        | 120                  |           12035.9        | 9502.9                                     | 100.0          |
| [MLPMixer-train](<docs/models/MLPMixer-train>)                                                       | 🚧       | 616 (19)                        | 101 (6)                         | 0                    |           18764.2        | 11494.41                                   | 100.0          |
| [Mnist-train](<docs/models/Mnist-train>)                                                             | 🚧       | 46 (15)                         | 10 (6)                          | 0                    |            2764.68       | 93.22                                      | 100.0          |
| [MobileNetSSD](<docs/models/MobileNetSSD>)                                                           | 🚧       | 444 (26)                        | 5 (1)                           | 32                   |             632.41       | 3916.94                                    | 18.49          |
| [OpenPose V2-train](<docs/models/OpenPose V2-train>)                                                 | 🚧       | 523 (14)                        | 279 (8)                         | 6                    |           11393.3        | 9510.22                                    | 100.0          |
| [ResNet18-train](<docs/models/ResNet18-train>)                                                       | 🚧       | 241 (19)                        | 142 (11)                        | 0                    |            5204.41       | 4253.54                                    | 100.0          |
| [ResNet50-train](<docs/models/ResNet50-train>)                                                       | 🚧       | 616 (19)                        | 372 (11)                        | 0                    |           12873.4        | 11336.77                                   | 100.0          |
| [SegFormer](<docs/models/SegFormer>)                                                                 | 🚧       | 676 (22)                        | 16 (1)                          | 4                    |           40588.6        | 4526.92                                    | 99.47          |
| [SegFormer-train](<docs/models/SegFormer-train>)                                                     | 🚧       | 1780 (35)                       | 157 (13)                        | 4                    |           77091.1        | 40218.95                                   | 100.0          |
| [U-Net-train](<docs/models/U-Net-train>)                                                             | 🚧       | 236 (15)                        | 140 (9)                         | 8                    |          111401          | 47223.2                                    | 100.0          |
| [Unet-brain-train](<docs/models/Unet-brain-train>)                                                   | 🚧       | 236 (15)                        | 140 (9)                         | 8                    |          106360          | 49837.21                                   | 100.0          |
| [Unet-carvana-train](<docs/models/Unet-carvana-train>)                                               | 🚧       | 232 (13)                        | 139 (8)                         | 8                    |          170987          | 90132.92                                   | 100.0          |
| [ViLT](<docs/models/ViLT>)                                                                           | 🚧       | 42 (16)                         | 8 (6)                           | 3                    |           18124.2        | 13852.77                                   | 87.8           |
| [XGLM](<docs/models/XGLM>)                                                                           | 🚧       | 1432 (28)                       | 26 (3)                          | 2                    |           54386.6        | 6854.98                                    | 95.5           |
| [YOLOS](<docs/models/YOLOS>)                                                                         | 🚧       | 952 (27)                        | 17 (2)                          | 6                    |           16766.2        | 9832.49                                    | 97.52          |
| [YOLOv3](<docs/models/YOLOv3>)                                                                       | 🚧       | 250 (7)                         | 2 (1)                           | 4                    |          321151          | 4876.85                                    | 98.96          |
| [albert/albert-xxlarge-v2](<docs/models/albert/albert-xxlarge-v2>)                                   | 🚧       | 791 (21)                        | 24 (1)                          | 3                    |           33471.7        | 2030.38                                    | 18.65          |
| [densenet121](<docs/models/densenet121>)                                                             | 🚧       | 432 (10)                        | 3 (1)                           | 594                  |            2828.75       | 2793.13                                    | 99.85          |
| [densenet161](<docs/models/densenet161>)                                                             | 🚧       | 572 (10)                        | 3 (1)                           | 1144                 |            7484.29       | 6596.96                                    | 99.75          |
| [densenet169](<docs/models/densenet169>)                                                             | 🚧       | 600 (10)                        | 3 (1)                           | 1238                 |            3393.13       | 4451.42                                    | 99.83          |
| [densenet201](<docs/models/densenet201>)                                                             | 🚧       | 712 (10)                        | 3 (1)                           | 1902                 |            4948.46       | 6743.3                                     | 99.83          |
| [dla34.in1k-train](<docs/models/dla34.in1k-train>)                                                   | 🚧       | 469 (18)                        | 268 (10)                        | 17                   |           10359          | 7271.43                                    | 100.0          |
| [ese_vovnet19b_dw.ra_in1k](<docs/models/ese_vovnet19b_dw.ra_in1k>)                                   | 🚧       | 111 (12)                        | 3 (1)                           | 16                   |            2989.01       | 1220.82                                    | 99.88          |
| [ese_vovnet19b_dw.ra_in1k-train](<docs/models/ese_vovnet19b_dw.ra_in1k-train>)                       | 🚧       | 360 (25)                        | 181 (11)                        | 16                   |            5150.35       | 4727.39                                    | 100.0          |
| [facebook/deit-base-patch16-224](<docs/models/facebook/deit-base-patch16-224>)                       | 🚧       | 685 (17)                        | 1 (1)                           | 2                    |           17744.8        | 2820.49                                    | 97.79          |
| [facebook/deit-base-patch16-224-train](<docs/models/facebook/deit-base-patch16-224-train>)           | 🚧       | 1854 (27)                       | 127 (8)                         | 2                    |           88673.6        | 7721.22                                    | 100.0          |
| [ghostnet_100.in1k-train](<docs/models/ghostnet_100.in1k-train>)                                     | 🚧       | 1468 (33)                       | 713 (16)                        | 64                   |            2034.93       | 3402.37                                    | 100.0          |
| [ghostnetv2_100.in1k](<docs/models/ghostnetv2_100.in1k>)                                             | 🚧       | 683 (18)                        | 28 (2)                          | 64                   |            2274.96       | 5907.13                                    | 4.61           |
| [ghostnetv2_100.in1k-train](<docs/models/ghostnetv2_100.in1k-train>)                                 | 🚧       | 2000 (39)                       | 1049 (21)                       | 64                   |            2418.67       | 6412.74                                    | 100.0          |
| [googlenet](<docs/models/googlenet>)                                                                 | 🚧       | 214 (15)                        | 13 (1)                          | 39                   |            1693.74       | 1162.09                                    | 99.84          |
| [hrnet_w18.ms_aug_in1k](<docs/models/hrnet_w18.ms_aug_in1k>)                                         | 🚧       | 1209 (11)                       | 31 (1)                          | 0                    |            5850.19       | 5876.01                                    | 99.7           |
| [hrnet_w18.ms_aug_in1k-train](<docs/models/hrnet_w18.ms_aug_in1k-train>)                             | 🚧       | 3998 (21)                       | 2299 (11)                       | 0                    |           12852.1        | 13068.67                                   | 100.0          |
| [inception_v4.tf_in1k](<docs/models/inception_v4.tf_in1k>)                                           | 🚧       | 495 (11)                        | 15 (2)                          | 83                   |           13142.6        | 5947.53                                    | 0.74           |
| [inception_v4.tf_in1k-train](<docs/models/inception_v4.tf_in1k-train>)                               | 🚧       | 1702 (24)                       | 933 (12)                        | 80                   |           32283.6        | 26993.59                                   | 100.0          |
| [microsoft/beit-base-patch16-224](<docs/models/microsoft/beit-base-patch16-224>)                     | 🚧       | 793 (21)                        | 13 (2)                          | 2                    |           18598.2        | 3492.29                                    | 98.79          |
| [microsoft/beit-base-patch16-224-train](<docs/models/microsoft/beit-base-patch16-224-train>)         | 🚧       | 2229 (34)                       | 165 (11)                        | 2                    |           90409.8        | 8388.46                                    | 100.0          |
| [microsoft/beit-large-patch16-224](<docs/models/microsoft/beit-large-patch16-224>)                   | 🚧       | 1573 (21)                       | 25 (2)                          | 2                    |           40086.1        | 8416.36                                    | 99.2           |
| [microsoft/beit-large-patch16-224-train](<docs/models/microsoft/beit-large-patch16-224-train>)       | 🚧       | 4437 (34)                       | 321 (11)                        | 2                    |          394638          | 20025.46                                   | 100.0          |
| [mixer_b16_224.goog_in21k](<docs/models/mixer_b16_224.goog_in21k>)                                   | 🚧       | 356 (11)                        | 1 (1)                           | 0                    |           18374.6        | 1824.2                                     | 42.74          |
| [mixer_b16_224.goog_in21k-train](<docs/models/mixer_b16_224.goog_in21k-train>)                       | 🚧       | 959 (18)                        | 101 (6)                         | 0                    |           59583.9        | 4591.9                                     | 100.0          |
| [mobilenetv1_100.ra4_e3600_r224_in1k-train](<docs/models/mobilenetv1_100.ra4_e3600_r224_in1k-train>) | 🚧       | 231 (15)                        | 165 (8)                         | 0                    |            3079.04       | 3681.48                                    | 100.0          |
| [regnet_y_128gf](<docs/models/regnet_y_128gf>)                                                       | 🚧       | 447 (10)                        | 3 (1)                           | 0                    |          493139          | 195865.59                                  | 11.07          |
| [regnet_y_16gf](<docs/models/regnet_y_16gf>)                                                         | 🚧       | 303 (10)                        | 1 (1)                           | 0                    |           14445.3        | 19612.74                                   | 99.91          |
| [retinanet_resnet50_fpn](<docs/models/retinanet_resnet50_fpn>)                                       | 🚧       | 973 (24)                        | 42 (9)                          | 16                   |            2756.29       | 19567.36                                   | N/A            |
| [retinanet_resnet50_fpn_v2](<docs/models/retinanet_resnet50_fpn_v2>)                                 | 🚧       | 483 (25)                        | 82 (10)                         | 16                   |            2679.39       | 20544.18                                   | N/A            |
| [speecht5-tts](<docs/models/speecht5-tts>)                                                           | 🚧       | 860 (20)                        | 1 (1)                           | 2                    |           52894.1        | 37370.16                                   | N/A            |
| [ssd300_vgg16](<docs/models/ssd300_vgg16>)                                                           | 🚧       | 248 (24)                        | 7 (3)                           | 36                   |            2934.32       | 3872.29                                    | N/A            |
| [ssdlite320_mobilenet_v3_large](<docs/models/ssdlite320_mobilenet_v3_large>)                         | 🚧       | 444 (26)                        | 5 (1)                           | 32                   |            1124.51       | 3837.98                                    | 24.8           |
| [swin_b](<docs/models/swin_b>)                                                                       | 🚧       | 1898 (30)                       | 29 (2)                          | 63                   |           18065          | 5599.42                                    | 91.78          |
| [swin_s](<docs/models/swin_s>)                                                                       | 🚧       | 1898 (30)                       | 29 (2)                          | 63                   |            8048          | 4342.2                                     | 11.9           |
| [swin_t](<docs/models/swin_t>)                                                                       | 🚧       | 968 (30)                        | 23 (2)                          | 39                   |            4378.52       | 2589.14                                    | 15.45          |
| [swin_v2_b](<docs/models/swin_v2_b>)                                                                 | 🚧       | 2474 (37)                       | 125 (4)                         | 33                   |           22598          | 6404.19                                    | 38.3           |
| [swin_v2_s](<docs/models/swin_v2_s>)                                                                 | 🚧       | 2474 (37)                       | 125 (4)                         | 33                   |           13169.5        | 4808.53                                    | 63.36          |
| [swin_v2_t](<docs/models/swin_v2_t>)                                                                 | 🚧       | 1256 (37)                       | 71 (4)                          | 21                   |            7097.07       | 2434.49                                    | 59.87          |
| [tf_efficientnet_lite0.in1k-train](<docs/models/tf_efficientnet_lite0.in1k-train>)                   | 🚧       | 403 (17)                        | 286 (9)                         | 5                    |            3301.97       | 7951.56                                    | 100.0          |
| [tf_efficientnet_lite1.in1k-train](<docs/models/tf_efficientnet_lite1.in1k-train>)                   | 🚧       | 523 (17)                        | 371 (9)                         | 5                    |            4705.74       | 11400.77                                   | 100.0          |
| [tf_efficientnet_lite2.in1k-train](<docs/models/tf_efficientnet_lite2.in1k-train>)                   | 🚧       | 523 (17)                        | 371 (9)                         | 5                    |            6387.76       | 13295.66                                   | 100.0          |
| [tf_efficientnet_lite3.in1k](<docs/models/tf_efficientnet_lite3.in1k>)                               | 🚧       | 221 (9)                         | 5 (1)                           | 5                    |            3137.76       | 16754.7                                    | 99.71          |
| [tf_efficientnet_lite3.in1k-train](<docs/models/tf_efficientnet_lite3.in1k-train>)                   | 🚧       | 595 (17)                        | 427 (10)                        | 5                    |            8848.73       | 21624.45                                   | 100.0          |
| [tf_efficientnet_lite4.in1k](<docs/models/tf_efficientnet_lite4.in1k>)                               | 🚧       | 275 (9)                         | 6 (1)                           | 5                    |            5641.46       | 24444.6                                    | 99.77          |
| [tf_efficientnet_lite4.in1k-train](<docs/models/tf_efficientnet_lite4.in1k-train>)                   | 🚧       | 739 (17)                        | 530 (10)                        | 5                    |           14941.2        | 31641.63                                   | 100.0          |
| [vit_b_16](<docs/models/vit_b_16>)                                                                   | 🚧       | 552 (17)                        | 13 (2)                          | 2                    |           14519.5        | 6937.92                                    | 98.97          |
| [vit_b_32](<docs/models/vit_b_32>)                                                                   | 🚧       | 552 (17)                        | 13 (2)                          | 2                    |            4921.7        | 2466.19                                    | 98.45          |
| [vit_h_14](<docs/models/vit_h_14>)                                                                   | 🚧       | 1452 (17)                       | 33 (2)                          | 2                    |          682420          | 175054.17                                  | 98.95          |
| [vit_l_16](<docs/models/vit_l_16>)                                                                   | 🚧       | 1092 (17)                       | 25 (2)                          | 2                    |           49747.2        | 19057.47                                   | 99.69          |
| [vit_l_32](<docs/models/vit_l_32>)                                                                   | 🚧       | 1092 (17)                       | 25 (2)                          | 2                    |           16132.9        | 6561.24                                    | 98.87          |
| [xception71.tf_in1k-train](<docs/models/xception71.tf_in1k-train>)                                   | 🚧       | 1370 (18)                       | 945 (9)                         | 0                    |           61316.1        | 70970.39                                   | 100.0          |
| [CLIP-train](<docs/models/CLIP-train>)                                                               | ❌       | 3942 (43)                       | N/A                             | N/A                  |           48369.4        | N/A                                        | N/A            |
| [FLAN-T5](<docs/models/FLAN-T5>)                                                                     | ❌       | 20020 (38)                      | N/A                             | N/A                  |           15877.8        | N/A                                        | N/A            |
| [GPTNeo](<docs/models/GPTNeo>)                                                                       | ❌       | 2725 (35)                       | N/A                             | N/A                  |           32029.6        | N/A                                        | N/A            |
| [OPT](<docs/models/OPT>)                                                                             | ❌       | 4001 (31)                       | N/A                             | N/A                  |           49341.4        | N/A                                        | N/A            |
| [Stable Diffusion V2](<docs/models/Stable Diffusion V2>)                                             | ❌       | 1870 (29)                       | N/A                             | N/A                  |               1.8306e+06 | N/A                                        | N/A            |
| [Whisper](<docs/models/Whisper>)                                                                     | ❌       | 4286 (17)                       | N/A                             | N/A                  |          242161          | N/A                                        | N/A            |
| [codegen](<docs/models/codegen>)                                                                     | ❌       | 9177 (36)                       | N/A                             | N/A                  |           38264.1        | N/A                                        | N/A            |
| [t5-base](<docs/models/t5-base>)                                                                     | ❌       | 14681 (38)                      | N/A                             | N/A                  |           30441.4        | N/A                                        | N/A            |
| [t5-large](<docs/models/t5-large>)                                                                   | ❌       | 22696 (38)                      | N/A                             | N/A                  |           90239.7        | N/A                                        | N/A            |
| [t5-small](<docs/models/t5-small>)                                                                   | ❌       | 6118 (38)                       | N/A                             | N/A                  |           10961.4        | N/A                                        | N/A            |

### Explanation of Metrics

**Model**: Name of the model.  
**Status**: Indicates whether the model is ❌ traced / 🚧 compiled / ✅ E2E on device.  
**Torch Ops Before (Unique Ops)**: The total number of operations used by the model in the original Torch implementation. The number in parenthesis represents the total unique ops.  
**Torch Ops Remain (Unique Ops)**: The total number of operations used after conversion to TTNN. The number in parenthesis represents the total unique ops.  
**To/From Device Ops**: The number of `to/from_device` operations (data transfer to/from the device).  
**Original Run Time (ms)**: Execution time (in seconds) of the model before conversion.  
**Compiled Run Time for 5th Iteration (ms)**: Execution time (in seconds) of the model after conversion for the 5th iteration.  
**Accuracy (%)**: Model accuracy on a predefined test dataset after conversion.  

***

## Quickstart

The `torch_ttnn` module has a `backend` function, which can be used with the `torch.compile()`.

```python
import torch
import torch_ttnn

# A torch Module
class FooModule(torch.nn.Module):
    ...
# Create a module
module = FooModule()

# Compile the module, with ttnn backend
device = ttnn.open_device(device_id=0)
option = torch_ttnn.TorchTtnnOption(device=self.device)
ttnn_module = torch.compile(module, backend=torch_ttnn.backend, options=option)

# Running inference / training
ttnn_module(input_data)
```

## Tracer
The tracer dump the information of fx graph such as node's op_name and shape.

For example, you can run this script to parse the information
```
PYTHONPATH=$(pwd) python3 tools/stat_models.py --trace_orig --backward --profile
ls stat/raw
```

By default, the raw result will be stored at `stat/raw`, and you can run this script to generate the report
```
python3 tools/generate_report.py
ls stat/
```
Now the `stat/` folder have these report
 - `fw_node_count.csv`
 - `bw_node_count.csv`
 - `fw_total_input_size_dist/`
 - `bw_total_input_size_dist/`
 - `fw_total_output_size_dist/`
 - `bw_total_output_size_dist/`
 - `profile/`

The `node_count.csv` show the node with `op_type` appear in the fx graph. This report can help analyze the frequency of op type appear in the graph.

The `*_total_*_size_dist/` statistics the `op_type`'s input/output_size distribution from all fx graph recored in `stat/raw`. This report can help analyze the memory footprint durning the calculation of `op_type`.

 - Notice: the default `input_shapes` in `tools/stat_torchvision.py` is `[1,3,224,224]`, which has dependency with `*_total_*_size_dist/` report.

 - Notice: the [aten ir interface is in there](https://pytorch.org/docs/stable/torch.compiler_ir.html)

[The `profile/` is the tools provided by pytorch](https://pytorch.org/tutorials/recipes/recipes/profiler_recipe.html), you can open it by the url: chrome://tracing


# For developers

## Install torch-ttnn with editable mode

During development, you may want to use the torch-ttnn package for testing.
In order to do that, you can install the torch-ttnn package in "editable"
mode with

```shell
pip install -e .
```

Now, you can utilize `torch_ttnn` in your Python code. Any modifications you make to the `torch_ttnn` package will take effect immediately, eliminating the need for constant reinstallation via pip.

## Build wheel file

For developers want to deploy the wheel, you can build the wheel file with

```shell
python -m build
```

Then you can upload the `.whl` file to the PyPI (Python Package Index).

## Run transformer models
To run transformer model with ttnn backend, run:
```
PYTHONPATH="$TT_METAL_HOME:$(pwd)" python3 tools/run_transformers.py --model "phiyodr/bert-large-finetuned-squad2" --backend torch_ttnn
```

You can also substitute the backend with `torch_stat` to run a reference comparison.

