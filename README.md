[comment]: <> (This README.md was generated by tools/collect_metrics.py.)
[comment]: <> (Please modify docs/README.md.in and/or collect_metrics.py to make permanent changes.)

# PyTorch 2.0 TTNN Compiler
This project allows to run PyTorch code on [Tenstorrent](https://tenstorrent.com/) hardware.

## Supported Models

The table below summarizes the results of running various ML models through our TTNN compiler. For each model, we track whether the run was successful, the number of operations before and after conversion, the number of `to_device` and `from_device` operations, performance metrics, and accuracy.

| Model                                                                                                | Status   | Torch Ops Before (Unique Ops)   | Torch Ops Remain (Unique Ops)   | To/From Device Ops   |   Original Run Time (ms) | Compiled Run Time (ms)   | Accuracy (%)   |
|:-----------------------------------------------------------------------------------------------------|:---------|:--------------------------------|:--------------------------------|:---------------------|-------------------------:|:-------------------------|:---------------|
| [Autoencoder (conv)](<docs/models/Autoencoder (conv)>)                                               | üöß       | 9 (3)                           | 9 (3)                           | 3                    |                  1891.44 | 117.12                   | 100.0          |
| [Autoencoder (conv)-train](<docs/models/Autoencoder (conv)-train>)                                   | üöß       | 24 (7)                          | 24 (7)                          | 3                    |                  3288.15 | 1006.88                  | 100.0          |
| [Autoencoder (linear)](<docs/models/Autoencoder (linear)>)                                           | üöß       | 22 (3)                          | 1 (1)                           | 1                    |                  2067.72 | 348.8                    | 100.0          |
| [Autoencoder (linear)-train](<docs/models/Autoencoder (linear)-train>)                               | üöß       | 104 (8)                         | 66 (4)                          | 40                   |                  3071.49 | 5712.42                  | 100.0          |
| [BERT](<docs/models/BERT>)                                                                           | üöß       | 1393 (21)                       | 4 (1)                           | 29                   |                 87997.4  | 36714.0                  | 98.88          |
| [Bloom](<docs/models/Bloom>)                                                                         | üöß       | 1407 (29)                       | 177 (3)                         | 78                   |                 63698.6  | 50522.43                 | 41.09          |
| [CLIP](<docs/models/CLIP>)                                                                           | üöß       | 1396 (30)                       | 984 (18)                        | 384                  |                  6240.22 | 18596.52                 | 94.17          |
| [CLIP-train](<docs/models/CLIP-train>)                                                               | ‚ùå       | 3943 (44)                       | N/A                             | N/A                  |                 35552    | N/A                      | N/A            |
| [DETR](<docs/models/DETR>)                                                                           | ‚ùå       | 1668 (41)                       | N/A                             | N/A                  |                 90287.9  | N/A                      | N/A            |
| [DPR](<docs/models/DPR>)                                                                             | üöß       | 720 (22)                        | 34 (5)                          | 21                   |                 10487.9  | 11140.7                  | 99.06          |
| [FLAN-T5](<docs/models/FLAN-T5>)                                                                     | ‚ùå       | 20106 (38)                      | N/A                             | N/A                  |                  9419.16 | N/A                      | N/A            |
| [Falcon](<docs/models/Falcon>)                                                                       | üöß       | 73 (7)                          | 71 (4)                          | 68                   |                276000    | 53564.11                 | 100.0          |
| [GLPN-KITTI](<docs/models/GLPN-KITTI>)                                                               | ‚ùå       | 3074 (30)                       | N/A                             | N/A                  |                124202    | N/A                      | N/A            |
| [GPT-2](<docs/models/GPT-2>)                                                                         | ‚ùå       | 748 (31)                        | N/A                             | N/A                  |                 28809    | N/A                      | N/A            |
| [GPTNeo](<docs/models/GPTNeo>)                                                                       | ‚ùå       | 2761 (36)                       | N/A                             | N/A                  |                 20194    | N/A                      | N/A            |
| [Hand Landmark](<docs/models/Hand Landmark>)                                                         | ‚ùå       | N/A                             | N/A                             | N/A                  |                  9091.77 | N/A                      | N/A            |
| [HardNet](<docs/models/HardNet>)                                                                     | üöß       | 245 (10)                        | 240 (5)                         | 67                   |                  5386.95 | 13945.11                 | 99.99          |
| [HardNet-train](<docs/models/HardNet-train>)                                                         | üöß       | 867 (21)                        | 720 (14)                        | 137                  |                 15201.5  | 58438.35                 | 100.0          |
| [Llama](<docs/models/Llama>)                                                                         | üöß       | 42 (12)                         | 16 (3)                          | 10                   |                475177    | 145424.99                | 100.0          |
| [MLPMixer](<docs/models/MLPMixer>)                                                                   | ‚ùå       | 253 (11)                        | N/A                             | N/A                  |                  4961.05 | N/A                      | N/A            |
| [MLPMixer-train](<docs/models/MLPMixer-train>)                                                       | ‚ùå       | 616 (19)                        | N/A                             | N/A                  |                 15330.6  | N/A                      | N/A            |
| [Mnist](<docs/models/Mnist>)                                                                         | üöß       | 14 (8)                          | 6 (3)                           | 3                    |                  3629.06 | 4772.23                  | 97.23          |
| [Mnist-train](<docs/models/Mnist-train>)                                                             | üöß       | 46 (15)                         | 34 (9)                          | 14                   |                  5148.65 | 5077.73                  | 100.0          |
| [MobileNetSSD](<docs/models/MobileNetSSD>)                                                           | ‚ùå       | 575 (34)                        | N/A                             | N/A                  |                   679    | N/A                      | N/A            |
| [MobileNetV2](<docs/models/MobileNetV2>)                                                             | üöß       | 154 (9)                         | 149 (3)                         | 45                   |                   823.67 | 27287.77                 | 99.98          |
| [OPT](<docs/models/OPT>)                                                                             | ‚ùå       | 4073 (32)                       | N/A                             | N/A                  |                 36117.7  | N/A                      | N/A            |
| [OpenPose V2](<docs/models/OpenPose V2>)                                                             | üöß       | 155 (7)                         | 148 (5)                         | 50                   |                  3691.98 | 8240.66                  | 93.11          |
| [OpenPose V2-train](<docs/models/OpenPose V2-train>)                                                 | üöß       | 523 (14)                        | 519 (12)                        | 69                   |                 12915.4  | 24325.98                 | 100.0          |
| [Perceiver IO](<docs/models/Perceiver IO>)                                                           | üöß       | 1532 (21)                       | 4 (2)                           | 31                   |                 82904.8  | 52707.15                 | 99.94          |
| [ResNet18](<docs/models/ResNet18>)                                                                   | üöß       | 70 (9)                          | 58 (4)                          | 17                   |                  1938.67 | 3859.02                  | 99.99          |
| [ResNet18-train](<docs/models/ResNet18-train>)                                                       | üöß       | 241 (19)                        | 228 (14)                        | 31                   |                  5761.76 | 16941.02                 | 100.0          |
| [ResNet50](<docs/models/ResNet50>)                                                                   | üöß       | 176 (9)                         | 156 (4)                         | 49                   |                  4270.97 | 15198.46                 | 99.98          |
| [ResNet50-train](<docs/models/ResNet50-train>)                                                       | üöß       | 616 (19)                        | 595 (14)                        | 71                   |                 14156.5  | 31114.96                 | 100.0          |
| [RoBERTa](<docs/models/RoBERTa>)                                                                     | üöß       | 719 (21)                        | 5 (2)                           | 18                   |                 33613.2  | 37768.52                 | 99.28          |
| [SegFormer](<docs/models/SegFormer>)                                                                 | ‚ùå       | 768 (27)                        | N/A                             | N/A                  |                 37512.3  | N/A                      | N/A            |
| [SegFormer-train](<docs/models/SegFormer-train>)                                                     | ‚ùå       | 1872 (40)                       | N/A                             | N/A                  |                 79520.2  | N/A                      | N/A            |
| [SqueezeBERT](<docs/models/SqueezeBERT>)                                                             | üöß       | 16 (9)                          | 4 (1)                           | 7                    |                  3105.28 | 5654.81                  | 100.0          |
| [Stable Diffusion V2](<docs/models/Stable Diffusion V2>)                                             | ‚ùå       | 1883 (32)                       | N/A                             | N/A                  |                975132    | N/A                      | N/A            |
| [U-Net](<docs/models/U-Net>)                                                                         | üöß       | 68 (6)                          | 68 (5)                          | 19                   |                 64794.5  | 66756.9                  | 100.0          |
| [U-Net-train](<docs/models/U-Net-train>)                                                             | üöß       | 236 (15)                        | 232 (12)                        | 27                   |                113494    | 122508.48                | 100.0          |
| [Unet-brain](<docs/models/Unet-brain>)                                                               | üöß       | 68 (6)                          | 68 (5)                          | 19                   |                 65300.1  | 66524.91                 | N/A            |
| [Unet-brain-train](<docs/models/Unet-brain-train>)                                                   | üöß       | 236 (15)                        | 232 (12)                        | 27                   |                113408    | 117961.59                | 100.0          |
| [Unet-carvana](<docs/models/Unet-carvana>)                                                           | üöß       | 67 (5)                          | 67 (5)                          | 18                   |                 81894.6  | 83436.88                 | 100.0          |
| [Unet-carvana-train](<docs/models/Unet-carvana-train>)                                               | üöß       | 232 (13)                        | 228 (11)                        | 26                   |                168478    | 179029.81                | 100.0          |
| [ViLT](<docs/models/ViLT>)                                                                           | üöß       | 55 (18)                         | 34 (13)                         | 10                   |                 24560.5  | 23936.03                 | 87.86          |
| [Whisper](<docs/models/Whisper>)                                                                     | ‚ùå       | 4294 (19)                       | N/A                             | N/A                  |                251466    | N/A                      | N/A            |
| [XGLM](<docs/models/XGLM>)                                                                           | üöß       | 1459 (30)                       | 117 (11)                        | 80                   |                 45548.3  | 53038.27                 | 95.44          |
| [YOLOS](<docs/models/YOLOS>)                                                                         | üöß       | 966 (28)                        | 76 (8)                          | 34                   |                 15833.5  | 36899.87                 | 96.8           |
| [YOLOv3](<docs/models/YOLOv3>)                                                                       | ‚ùå       | 268 (10)                        | N/A                             | N/A                  |                228855    | N/A                      | N/A            |
| [YOLOv5](<docs/models/YOLOv5>)                                                                       | üöß       | 3 (3)                           | 3 (3)                           | 1                    |                 31547.3  | 29542.33                 | 100.0          |
| [albert/albert-base-v2](<docs/models/albert/albert-base-v2>)                                         | üöß       | 791 (21)                        | 29 (4)                          | 17                   |                  2697.32 | 23844.98                 | 67.25          |
| [albert/albert-base-v2-classification](<docs/models/albert/albert-base-v2-classification>)           | üöß       | 779 (21)                        | 3 (1)                           | 18                   |                  3302.11 | 8902.78                  | 99.93          |
| [albert/albert-large-v2](<docs/models/albert/albert-large-v2>)                                       | üöß       | 1547 (21)                       | 53 (4)                          | 29                   |                  4874.39 | 22334.58                 | 22.61          |
| [albert/albert-xlarge-v2](<docs/models/albert/albert-xlarge-v2>)                                     | üöß       | 1547 (21)                       | 53 (4)                          | 29                   |                 11857.4  | 24196.49                 | 48.26          |
| [albert/albert-xxlarge-v2](<docs/models/albert/albert-xxlarge-v2>)                                   | üöß       | 791 (21)                        | 77 (5)                          | 41                   |                 24806.6  | 30891.67                 | 13.95          |
| [codegen](<docs/models/codegen>)                                                                     | ‚ùå       | 9237 (37)                       | N/A                             | N/A                  |                 22521.2  | N/A                      | N/A            |
| [densenet121](<docs/models/densenet121>)                                                             | üöß       | 432 (10)                        | 428 (6)                         | 121                  |                  3119.59 | 19502.76                 | 99.99          |
| [densenet161](<docs/models/densenet161>)                                                             | üöß       | 572 (10)                        | 568 (6)                         | 161                  |                  8840.35 | 38255.59                 | 99.99          |
| [densenet169](<docs/models/densenet169>)                                                             | üöß       | 600 (10)                        | 596 (6)                         | 169                  |                  3715.21 | 24528.3                  | 99.99          |
| [densenet201](<docs/models/densenet201>)                                                             | üöß       | 712 (10)                        | 708 (6)                         | 201                  |                  4262.16 | 38844.83                 | 99.99          |
| [distilbert-base-uncased](<docs/models/distilbert-base-uncased>)                                     | üöß       | 367 (17)                        | 20 (3)                          | 21                   |                  6164.72 | 10650.21                 | 99.65          |
| [dla34.in1k](<docs/models/dla34.in1k>)                                                               | üöß       | 135 (9)                         | 119 (5)                         | 34                   |                  4236.75 | 5844.8                   | 100.0          |
| [dla34.in1k-train](<docs/models/dla34.in1k-train>)                                                   | üöß       | 469 (18)                        | 435 (13)                        | 57                   |                 14569    | 22790.82                 | 100.0          |
| [ese_vovnet19b_dw.ra_in1k](<docs/models/ese_vovnet19b_dw.ra_in1k>)                                   | üöß       | 111 (12)                        | 102 (6)                         | 27                   |                  2693.49 | 15925.36                 | 99.98          |
| [ese_vovnet19b_dw.ra_in1k-train](<docs/models/ese_vovnet19b_dw.ra_in1k-train>)                       | üöß       | 360 (25)                        | 337 (16)                        | 60                   |                  6713.64 | 17637.35                 | 100.0          |
| [facebook/deit-base-patch16-224](<docs/models/facebook/deit-base-patch16-224>)                       | üöß       | 686 (18)                        | 452 (6)                         | 195                  |                 18820.2  | 17966.44                 | 97.18          |
| [facebook/deit-base-patch16-224-train](<docs/models/facebook/deit-base-patch16-224-train>)           | üöß       | 1856 (28)                       | 1342 (15)                       | 658                  |                 84007.3  | 33909.57                 | 100.0          |
| [ghostnet_100.in1k](<docs/models/ghostnet_100.in1k>)                                                 | üöß       | 515 (14)                        | 334 (6)                         | 72                   |                  1539.98 | 20903.3                  | 99.97          |
| [ghostnet_100.in1k-train](<docs/models/ghostnet_100.in1k-train>)                                     | üöß       | 1468 (33)                       | 1234 (24)                       | 190                  |                  1642.75 | 28104.76                 | 100.0          |
| [ghostnetv2_100.in1k](<docs/models/ghostnetv2_100.in1k>)                                             | üöß       | 809 (20)                        | 489 (12)                        | 95                   |                  2396.85 | 31140.17                 | 99.93          |
| [ghostnetv2_100.in1k-train](<docs/models/ghostnetv2_100.in1k-train>)                                 | ‚ùå       | 2126 (41)                       | N/A                             | N/A                  |                  2206.87 | N/A                      | N/A            |
| [googlenet](<docs/models/googlenet>)                                                                 | üöß       | 214 (15)                        | 201 (6)                         | 61                   |                  1824.22 | 18052.92                 | 99.97          |
| [hrnet_w18.ms_aug_in1k](<docs/models/hrnet_w18.ms_aug_in1k>)                                         | üöß       | 1488 (14)                       | 986 (8)                         | 281                  |                  5341.42 | 33174.48                 | 99.94          |
| [hrnet_w18.ms_aug_in1k-train](<docs/models/hrnet_w18.ms_aug_in1k-train>)                             | ‚ùå       | 4277 (24)                       | N/A                             | N/A                  |                 15691.6  | N/A                      | N/A            |
| [inception_v4.tf_in1k](<docs/models/inception_v4.tf_in1k>)                                           | üöß       | 495 (11)                        | 491 (6)                         | 150                  |                 15078.5  | 33517.69                 | 99.98          |
| [inception_v4.tf_in1k-train](<docs/models/inception_v4.tf_in1k-train>)                               | üöß       | 1702 (24)                       | 1642 (16)                       | 236                  |                 32621.6  | 67497.28                 | 100.0          |
| [microsoft/beit-base-patch16-224](<docs/models/microsoft/beit-base-patch16-224>)                     | üöß       | 793 (21)                        | 487 (7)                         | 195                  |                 14059.3  | 13523.79                 | 98.95          |
| [microsoft/beit-base-patch16-224-train](<docs/models/microsoft/beit-base-patch16-224-train>)         | üöß       | 2229 (34)                       | 1533 (20)                       | 809                  |                 77820.7  | 45686.4                  | 100.0          |
| [microsoft/beit-large-patch16-224](<docs/models/microsoft/beit-large-patch16-224>)                   | üöß       | 1573 (21)                       | 967 (7)                         | 387                  |                 47765.3  | 30186.21                 | 99.47          |
| [microsoft/beit-large-patch16-224-train](<docs/models/microsoft/beit-large-patch16-224-train>)       | üöß       | 4437 (34)                       | 3045 (20)                       | 1613                 |                502292    | 86519.69                 | 100.0          |
| [mixer_b16_224.goog_in21k](<docs/models/mixer_b16_224.goog_in21k>)                                   | üöß       | 356 (11)                        | 5 (4)                           | 2                    |                 16753.8  | 12729.61                 | 57.27          |
| [mixer_b16_224.goog_in21k-train](<docs/models/mixer_b16_224.goog_in21k-train>)                       | üöß       | 959 (18)                        | 462 (10)                        | 358                  |                 71916.6  | 28923.13                 | 100.0          |
| [mobilenet_v2](<docs/models/mobilenet_v2>)                                                           | üöß       | 154 (9)                         | 149 (3)                         | 45                   |                  1397.24 | 25538.22                 | 99.98          |
| [mobilenet_v3_large](<docs/models/mobilenet_v3_large>)                                               | üöß       | 188 (11)                        | 181 (5)                         | 44                   |                   692.14 | 8806.79                  | 99.94          |
| [mobilenet_v3_small](<docs/models/mobilenet_v3_small>)                                               | üöß       | 158 (11)                        | 153 (5)                         | 39                   |                   397.69 | 12225.48                 | 99.93          |
| [mobilenetv1_100.ra4_e3600_r224_in1k](<docs/models/mobilenetv1_100.ra4_e3600_r224_in1k>)             | üöß       | 85 (7)                          | 81 (3)                          | 27                   |                  1867.57 | 14287.7                  | 99.19          |
| [mobilenetv1_100.ra4_e3600_r224_in1k-train](<docs/models/mobilenetv1_100.ra4_e3600_r224_in1k-train>) | üöß       | 231 (15)                        | 225 (10)                        | 32                   |                  3396.44 | 21138.87                 | 100.0          |
| [regnet_x_16gf](<docs/models/regnet_x_16gf>)                                                         | üöß       | 235 (8)                         | 209 (3)                         | 67                   |                 14731.1  | 27579.82                 | 99.96          |
| [regnet_x_1_6gf](<docs/models/regnet_x_1_6gf>)                                                       | üöß       | 195 (8)                         | 173 (3)                         | 55                   |                  1863.75 | 12292.2                  | 99.97          |
| [regnet_x_32gf](<docs/models/regnet_x_32gf>)                                                         | üöß       | 245 (8)                         | 218 (3)                         | 70                   |                 28537.1  | 41351.05                 | 99.97          |
| [regnet_x_3_2gf](<docs/models/regnet_x_3_2gf>)                                                       | üöß       | 265 (8)                         | 236 (3)                         | 76                   |                  3232.49 | 14501.43                 | 99.95          |
| [regnet_x_400mf](<docs/models/regnet_x_400mf>)                                                       | üöß       | 235 (8)                         | 209 (3)                         | 67                   |                  1113.59 | 8219.44                  | 99.96          |
| [regnet_x_800mf](<docs/models/regnet_x_800mf>)                                                       | üöß       | 175 (8)                         | 155 (3)                         | 49                   |                  1133.37 | 13324.6                  | 99.96          |
| [regnet_x_8gf](<docs/models/regnet_x_8gf>)                                                           | üöß       | 245 (8)                         | 218 (3)                         | 70                   |                  7373.72 | 17902.86                 | 99.95          |
| [regnet_y_128gf](<docs/models/regnet_y_128gf>)                                                       | üöß       | 447 (10)                        | 362 (3)                         | 136                  |                497380    | 515864.52                | 99.86          |
| [regnet_y_16gf](<docs/models/regnet_y_16gf>)                                                         | üöß       | 303 (10)                        | 245 (3)                         | 91                   |                 14178.6  | 32298.09                 | 99.94          |
| [regnet_y_1_6gf](<docs/models/regnet_y_1_6gf>)                                                       | üöß       | 447 (10)                        | 362 (3)                         | 136                  |                  1912.71 | 19469.84                 | 99.9           |
| [regnet_y_32gf](<docs/models/regnet_y_32gf>)                                                         | üöß       | 335 (10)                        | 271 (3)                         | 101                  |                 29037.6  | 49345.09                 | 99.93          |
| [regnet_y_3_2gf](<docs/models/regnet_y_3_2gf>)                                                       | üöß       | 351 (10)                        | 284 (3)                         | 106                  |                  3515.61 | 20654.3                  | 99.93          |
| [regnet_y_400mf](<docs/models/regnet_y_400mf>)                                                       | üöß       | 271 (10)                        | 219 (3)                         | 81                   |                   736.1  | 17690.14                 | 99.77          |
| [regnet_y_800mf](<docs/models/regnet_y_800mf>)                                                       | üöß       | 239 (10)                        | 193 (3)                         | 71                   |                  1178.01 | 22468.68                 | 99.88          |
| [regnet_y_8gf](<docs/models/regnet_y_8gf>)                                                           | üöß       | 287 (10)                        | 232 (3)                         | 86                   |                  8109.39 | 23788.43                 | 99.96          |
| [resnet101](<docs/models/resnet101>)                                                                 | üöß       | 346 (9)                         | 309 (4)                         | 100                  |                  9494.87 | 18970.72                 | 99.96          |
| [resnet152](<docs/models/resnet152>)                                                                 | üöß       | 516 (9)                         | 462 (4)                         | 151                  |                 10702.9  | 31676.36                 | 99.95          |
| [resnet18](<docs/models/resnet18>)                                                                   | üöß       | 70 (9)                          | 58 (4)                          | 17                   |                  2505.24 | 9563.54                  | 99.99          |
| [resnet34](<docs/models/resnet34>)                                                                   | üöß       | 126 (9)                         | 106 (4)                         | 33                   |                  4604.55 | 7574.07                  | 99.99          |
| [resnet50](<docs/models/resnet50>)                                                                   | üöß       | 176 (9)                         | 156 (4)                         | 49                   |                  5069.67 | 12100.15                 | 99.98          |
| [resnext101_32x8d](<docs/models/resnext101_32x8d>)                                                   | üöß       | 346 (9)                         | 309 (4)                         | 100                  |                 15275.1  | 26292.44                 | 99.97          |
| [resnext101_64x4d](<docs/models/resnext101_64x4d>)                                                   | üöß       | 346 (9)                         | 309 (4)                         | 100                  |                 14418.3  | 25311.44                 | 99.97          |
| [resnext50_32x4d](<docs/models/resnext50_32x4d>)                                                     | üöß       | 176 (9)                         | 156 (4)                         | 49                   |                  4342.79 | 9475.41                  | 99.98          |
| [retinanet_resnet50_fpn](<docs/models/retinanet_resnet50_fpn>)                                       | ‚ùå       | 1107 (32)                       | N/A                             | N/A                  |                  1964.5  | N/A                      | N/A            |
| [retinanet_resnet50_fpn_v2](<docs/models/retinanet_resnet50_fpn_v2>)                                 | ‚ùå       | 617 (33)                        | N/A                             | N/A                  |                  2092.68 | N/A                      | N/A            |
| [speecht5-tts](<docs/models/speecht5-tts>)                                                           | üöß       | 862 (21)                        | 15 (5)                          | 10                   |                 40700.4  | 46423.32                 | N/A            |
| [ssd300_vgg16](<docs/models/ssd300_vgg16>)                                                           | ‚ùå       | 387 (32)                        | N/A                             | N/A                  |                  3237.68 | N/A                      | N/A            |
| [ssdlite320_mobilenet_v3_large](<docs/models/ssdlite320_mobilenet_v3_large>)                         | ‚ùå       | 575 (34)                        | N/A                             | N/A                  |                   596.82 | N/A                      | N/A            |
| [swin_b](<docs/models/swin_b>)                                                                       | üöß       | 1898 (30)                       | 468 (16)                        | 170                  |                 13987    | 65733.39                 | 87.35          |
| [swin_s](<docs/models/swin_s>)                                                                       | üöß       | 1898 (30)                       | 472 (16)                        | 172                  |                  8137.11 | 24908.32                 | 84.84          |
| [swin_t](<docs/models/swin_t>)                                                                       | üöß       | 968 (30)                        | 244 (16)                        | 88                   |                  4340.77 | 50104.0                  | 89.2           |
| [swin_v2_b](<docs/models/swin_v2_b>)                                                                 | üöß       | 2474 (37)                       | 664 (18)                        | 221                  |                 17728.7  | 45214.02                 | 63.44          |
| [swin_v2_s](<docs/models/swin_v2_s>)                                                                 | üöß       | 2474 (37)                       | 668 (18)                        | 223                  |                 10376.2  | 31108.75                 | 51.51          |
| [swin_v2_t](<docs/models/swin_v2_t>)                                                                 | üöß       | 1256 (37)                       | 344 (18)                        | 109                  |                  5601.18 | 51767.8                  | 36.16          |
| [t5-base](<docs/models/t5-base>)                                                                     | ‚ùå       | 14731 (38)                      | N/A                             | N/A                  |                 19610    | N/A                      | N/A            |
| [t5-large](<docs/models/t5-large>)                                                                   | ‚ùå       | 22738 (38)                      | N/A                             | N/A                  |                 56795.8  | N/A                      | N/A            |
| [t5-small](<docs/models/t5-small>)                                                                   | ‚ùå       | 6160 (38)                       | N/A                             | N/A                  |                  6984.97 | N/A                      | N/A            |
| [textattack/albert-base-v2-imdb](<docs/models/textattack/albert-base-v2-imdb>)                       | üöß       | 782 (22)                        | 31 (5)                          | 18                   |                  4344.6  | 9128.14                  | 100.0          |
| [tf_efficientnet_lite0.in1k](<docs/models/tf_efficientnet_lite0.in1k>)                               | üöß       | 149 (9)                         | 145 (4)                         | 42                   |                  2246.02 | 32571.98                 | 99.98          |
| [tf_efficientnet_lite0.in1k-train](<docs/models/tf_efficientnet_lite0.in1k-train>)                   | üöß       | 403 (17)                        | 397 (11)                        | 56                   |                  3764.72 | 43012.47                 | 100.0          |
| [tf_efficientnet_lite1.in1k](<docs/models/tf_efficientnet_lite1.in1k>)                               | üöß       | 194 (9)                         | 190 (4)                         | 57                   |                  2633.23 | 10719.02                 | 99.98          |
| [tf_efficientnet_lite1.in1k-train](<docs/models/tf_efficientnet_lite1.in1k-train>)                   | üöß       | 523 (17)                        | 517 (11)                        | 76                   |                  4180.12 | 18597.05                 | 100.0          |
| [tf_efficientnet_lite2.in1k](<docs/models/tf_efficientnet_lite2.in1k>)                               | üöß       | 194 (9)                         | 190 (4)                         | 57                   |                  2190.06 | 45724.42                 | 99.98          |
| [tf_efficientnet_lite2.in1k-train](<docs/models/tf_efficientnet_lite2.in1k-train>)                   | üöß       | 523 (17)                        | 517 (11)                        | 76                   |                  5209.47 | 35353.3                  | 100.0          |
| [tf_efficientnet_lite3.in1k](<docs/models/tf_efficientnet_lite3.in1k>)                               | üöß       | 221 (9)                         | 217 (4)                         | 66                   |                  3661.94 | 21802.45                 | 99.98          |
| [tf_efficientnet_lite3.in1k-train](<docs/models/tf_efficientnet_lite3.in1k-train>)                   | üöß       | 595 (17)                        | 589 (11)                        | 88                   |                  8237.32 | 32923.81                 | 100.0          |
| [tf_efficientnet_lite4.in1k](<docs/models/tf_efficientnet_lite4.in1k>)                               | üöß       | 275 (9)                         | 271 (4)                         | 84                   |                  7692.62 | 26752.02                 | 99.98          |
| [tf_efficientnet_lite4.in1k-train](<docs/models/tf_efficientnet_lite4.in1k-train>)                   | üöß       | 739 (17)                        | 733 (11)                        | 112                  |                 14548.5  | 63040.18                 | 100.0          |
| [twmkn9/albert-base-v2-squad2](<docs/models/twmkn9/albert-base-v2-squad2>)                           | üöß       | 783 (23)                        | 4 (1)                           | 20                   |                  4372.69 | 18665.22                 | 97.85          |
| [vgg11](<docs/models/vgg11>)                                                                         | üöß       | 33 (8)                          | 26 (5)                          | 11                   |                 11566.8  | 21669.92                 | 99.97          |
| [vgg11_bn](<docs/models/vgg11_bn>)                                                                   | üöß       | 41 (9)                          | 34 (6)                          | 11                   |                 12037.7  | 15542.34                 | 99.98          |
| [vgg13](<docs/models/vgg13>)                                                                         | üöß       | 37 (8)                          | 30 (5)                          | 13                   |                 19284.9  | 22692.15                 | 99.98          |
| [vgg13_bn](<docs/models/vgg13_bn>)                                                                   | üöß       | 47 (9)                          | 40 (6)                          | 13                   |                 20342.8  | 24069.13                 | 99.98          |
| [vgg16](<docs/models/vgg16>)                                                                         | üöß       | 43 (8)                          | 36 (5)                          | 16                   |                 24507.2  | 33407.92                 | 99.98          |
| [vgg16_bn](<docs/models/vgg16_bn>)                                                                   | üöß       | 56 (9)                          | 49 (6)                          | 16                   |                 22883.5  | 28928.25                 | 99.98          |
| [vgg19](<docs/models/vgg19>)                                                                         | üöß       | 49 (8)                          | 42 (5)                          | 19                   |                 29946.7  | 33254.04                 | 99.98          |
| [vgg19_bn](<docs/models/vgg19_bn>)                                                                   | üöß       | 65 (9)                          | 58 (6)                          | 19                   |                 30147.3  | 35520.43                 | 99.97          |
| [vit_b_16](<docs/models/vit_b_16>)                                                                   | üöß       | 552 (17)                        | 259 (7)                         | 111                  |                 18887    | 44910.59                 | 99.12          |
| [vit_b_32](<docs/models/vit_b_32>)                                                                   | üöß       | 552 (17)                        | 259 (8)                         | 110                  |                  6076.5  | 16745.67                 | 98.08          |
| [vit_h_14](<docs/models/vit_h_14>)                                                                   | üöß       | 1452 (17)                       | 327 (7)                         | 163                  |                651909    | 906988.18                | 99.29          |
| [vit_l_16](<docs/models/vit_l_16>)                                                                   | üöß       | 1092 (17)                       | 511 (7)                         | 219                  |                 65033.8  | 105900.35                | 99.62          |
| [vit_l_32](<docs/models/vit_l_32>)                                                                   | üöß       | 1092 (17)                       | 247 (7)                         | 123                  |                 20153.6  | 38897.3                  | 98.86          |
| [wide_resnet101_2](<docs/models/wide_resnet101_2>)                                                   | üöß       | 346 (9)                         | 309 (4)                         | 100                  |                 22459.3  | 29450.88                 | 99.97          |
| [wide_resnet50_2](<docs/models/wide_resnet50_2>)                                                     | üöß       | 176 (9)                         | 156 (4)                         | 49                   |                 11712    | 20050.56                 | 99.98          |
| [xception71.tf_in1k](<docs/models/xception71.tf_in1k>)                                               | üöß       | 393 (9)                         | 372 (3)                         | 80                   |                 17163.9  | 35442.98                 | 99.98          |
| [xception71.tf_in1k-train](<docs/models/xception71.tf_in1k-train>)                                   | üöß       | 1370 (18)                       | 1348 (12)                       | 108                  |                 69208.5  | 105035.85                | 100.0          |

### Explanation of Metrics

**Model**: Name of the model.  
**Status**: Indicates whether the model is ‚ùå traced / üöß compiled / ‚úÖ E2E on device.  
**Torch Ops Before (Unique Ops)**: The total number of operations used by the model in the original Torch implementation. The number in parenthesis represents the total unique ops.  
**Torch Ops Remain (Unique Ops)**: The total number of operations used after conversion to TTNN. The number in parenthesis represents the total unique ops.  
**To/From Device Ops**: The number of `to/from_device` operations (data transfer to/from the device).  
**Original Run Time (ms)**: Execution time (in seconds) of the model before conversion.  
**Compiled Run Time (ms)**: Execution time (in seconds) of the model after conversion.  
**Accuracy (%)**: Model accuracy on a predefined test dataset after conversion.  

***

## Quickstart

The `torch_ttnn` module has a `backend` function, which can be used with the `torch.compile()`.

```python
import torch
import torch_ttnn

# A torch Module
class FooModule(torch.nn.Module):
    ...
# Create a module
module = FooModule()

# Compile the module, with ttnn backend
device = ttnn.open_device(device_id=0)
option = torch_ttnn.TorchTtnnOption(device=self.device)
ttnn_module = torch.compile(module, backend=torch_ttnn.backend, options=option)

# Running inference / training
ttnn_module(input_data)
```

## Tracer
The tracer dump the information of fx graph such as node's op_name and shape.

For example, you can run this script to parse the information
```
PYTHONPATH=$(pwd) python3 tools/stat_models.py --trace_orig --backward --profile
ls stat/raw
```

By default, the raw result will be stored at `stat/raw`, and you can run this script to generate the report
```
python3 tools/generate_report.py
ls stat/
```
Now the `stat/` folder have these report
 - `fw_node_count.csv`
 - `bw_node_count.csv`
 - `fw_total_input_size_dist/`
 - `bw_total_input_size_dist/`
 - `fw_total_output_size_dist/`
 - `bw_total_output_size_dist/`
 - `profile/`

The `node_count.csv` show the node with `op_type` appear in the fx graph. This report can help analyze the frequency of op type appear in the graph.

The `*_total_*_size_dist/` statistics the `op_type`'s input/output_size distribution from all fx graph recored in `stat/raw`. This report can help analyze the memory footprint durning the calculation of `op_type`.

 - Notice: the default `input_shapes` in `tools/stat_torchvision.py` is `[1,3,224,224]`, which has dependency with `*_total_*_size_dist/` report.

 - Notice: the [aten ir interface is in there](https://pytorch.org/docs/stable/torch.compiler_ir.html)

[The `profile/` is the tools provided by pytorch](https://pytorch.org/tutorials/recipes/recipes/profiler_recipe.html), you can open it by the url: chrome://tracing


# For developers

## Install torch-ttnn with editable mode

During development, you may want to use the torch-ttnn package for testing.
In order to do that, you can install the torch-ttnn package in "editable"
mode with

```shell
pip install -e .
```

Now, you can utilize `torch_ttnn` in your Python code. Any modifications you make to the `torch_ttnn` package will take effect immediately, eliminating the need for constant reinstallation via pip.

## Build wheel file

For developers want to deploy the wheel, you can build the wheel file with

```shell
python -m build
```

Then you can upload the `.whl` file to the PyPI (Python Package Index).

## Run transformer models
To run transformer model with ttnn backend, run:
```
PYTHONPATH="$TT_METAL_HOME:$(pwd)" python3 tools/run_transformers.py --model "phiyodr/bert-large-finetuned-squad2" --backend torch_ttnn
```

You can also substitute the backend with `torch_stat` to run a reference comparison.

