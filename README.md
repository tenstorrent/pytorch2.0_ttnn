[comment]: <> (This README.md was generated by tools/collect_metrics.py.)
[comment]: <> (Please modify docs/README.md.in and/or collect_metrics.py to make permanent changes.)
[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/tenstorrent/pytorch2.0_ttnn)

# PyTorch 2.0 TTNN Compiler
This project allows to run PyTorch code on [Tenstorrent](https://tenstorrent.com/) hardware.

## Supported Models

The table below summarizes the results of running various ML models through our TTNN compiler. For each model, we track whether the run was successful, the number of operations before and after conversion, the number of `to_device` and `from_device` operations, performance metrics, and accuracy.

| Model                                                                                                | Status   | Torch Ops Before (Unique Ops)   | Torch Ops Remain (Unique Ops)   | To/From Device Ops   |   Original Run Time (ms) | Compiled Run Time for 5th Iteration (ms)   | Accuracy (%)   |
|:-----------------------------------------------------------------------------------------------------|:---------|:--------------------------------|:--------------------------------|:---------------------|-------------------------:|:-------------------------------------------|:---------------|
| [Autoencoder (linear)](<docs/models/Autoencoder (linear)>)                                           | ‚úÖ       | 22 (3)                          | 0 (0)                           | 0                    |                  1313.81 | 1.7                                        | 100.0          |
| [BERT](<docs/models/BERT>)                                                                           | ‚úÖ       | 1393 (21)                       | 0 (0)                           | 0                    |                 82658.1  | 51.46                                      | 99.53          |
| [DPR](<docs/models/DPR>)                                                                             | ‚úÖ       | 720 (22)                        | 0 (0)                           | 1                    |                  2616.76 | 11.93                                      | 99.38          |
| [HardNet](<docs/models/HardNet>)                                                                     | ‚úÖ       | 245 (10)                        | 0 (0)                           | 124                  |                  5093.06 | 30.53                                      | 98.41          |
| [Llama](<docs/models/Llama>)                                                                         | ‚úÖ       | 40 (11)                         | 0 (0)                           | 2                    |                166589    | 130879.74                                  | 100.0          |
| [MLPMixer](<docs/models/MLPMixer>)                                                                   | ‚úÖ       | 253 (11)                        | 0 (0)                           | 0                    |                  5175.59 | 9.66                                       | 99.99          |
| [Mnist](<docs/models/Mnist>)                                                                         | ‚úÖ       | 14 (8)                          | 0 (0)                           | 1                    |                    34.35 | 2.37                                       | 99.42          |
| [MobileNetV2](<docs/models/MobileNetV2>)                                                             | ‚úÖ       | 154 (9)                         | 0 (0)                           | 0                    |                  1331.45 | 22.83                                      | 99.09          |
| [OpenPose V2](<docs/models/OpenPose V2>)                                                             | ‚úÖ       | 155 (7)                         | 0 (0)                           | 6                    |                  2837.52 | 27.13                                      | 91.49          |
| [Perceiver IO](<docs/models/Perceiver IO>)                                                           | ‚úÖ       | 1531 (20)                       | 0 (0)                           | 1                    |                 49088.6  | 52.57                                      | 99.95          |
| [ResNet18](<docs/models/ResNet18>)                                                                   | ‚úÖ       | 70 (9)                          | 0 (0)                           | 1                    |                  2311.25 | 10.71                                      | 99.17          |
| [ResNet50](<docs/models/ResNet50>)                                                                   | ‚úÖ       | 176 (9)                         | 0 (0)                           | 1                    |                  4329.36 | 22.83                                      | 98.61          |
| [RoBERTa](<docs/models/RoBERTa>)                                                                     | ‚úÖ       | 719 (21)                        | 0 (0)                           | 3                    |                 10956.8  | 43.95                                      | 7.19           |
| [SqueezeBERT](<docs/models/SqueezeBERT>)                                                             | ‚úÖ       | 16 (9)                          | 0 (0)                           | 3                    |                  1232.12 | 254.73                                     | 100.0          |
| [U-Net](<docs/models/U-Net>)                                                                         | ‚úÖ       | 68 (6)                          | 0 (0)                           | 12                   |                 62545.5  | 12.74                                      | 100.0          |
| [Unet-brain](<docs/models/Unet-brain>)                                                               | ‚úÖ       | 68 (6)                          | 0 (0)                           | 12                   |                 64887.4  | 13.66                                      | N/A            |
| [Unet-carvana](<docs/models/Unet-carvana>)                                                           | ‚úÖ       | 67 (5)                          | 0 (0)                           | 12                   |                 65135.7  | 38.51                                      | 99.69          |
| [YOLOv5](<docs/models/YOLOv5>)                                                                       | ‚úÖ       | 3 (3)                           | 0 (0)                           | 0                    |                 14363.2  | 11575.44                                   | 99.98          |
| [albert/albert-base-v2](<docs/models/albert/albert-base-v2>)                                         | ‚úÖ       | 791 (21)                        | 0 (0)                           | 3                    |                  1071.69 | 18.29                                      | 98.82          |
| [albert/albert-base-v2-classification](<docs/models/albert/albert-base-v2-classification>)           | ‚úÖ       | 779 (21)                        | 0 (0)                           | 2                    |                  1443.3  | 15.73                                      | 99.97          |
| [albert/albert-large-v2](<docs/models/albert/albert-large-v2>)                                       | ‚úÖ       | 1547 (21)                       | 0 (0)                           | 3                    |                  2595.02 | 32.09                                      | 98.95          |
| [albert/albert-xlarge-v2](<docs/models/albert/albert-xlarge-v2>)                                     | ‚úÖ       | 1547 (21)                       | 0 (0)                           | 3                    |                  8001.78 | 73.64                                      | 97.36          |
| [densenet121](<docs/models/densenet121>)                                                             | ‚úÖ       | 432 (10)                        | 0 (0)                           | 597                  |                  2850.08 | 55.27                                      | 99.74          |
| [densenet161](<docs/models/densenet161>)                                                             | ‚úÖ       | 572 (10)                        | 0 (0)                           | 1147                 |                  7768.45 | 80.38                                      | 99.49          |
| [densenet169](<docs/models/densenet169>)                                                             | ‚úÖ       | 600 (10)                        | 0 (0)                           | 1241                 |                  3610.98 | 77.09                                      | 99.59          |
| [distilbert-base-uncased](<docs/models/distilbert-base-uncased>)                                     | ‚úÖ       | 361 (16)                        | 0 (0)                           | 1                    |                  1738.74 | 9.0                                        | 99.9           |
| [dla34.in1k](<docs/models/dla34.in1k>)                                                               | ‚úÖ       | 135 (9)                         | 0 (0)                           | 23                   |                  4075.51 | 20.33                                      | 99.5           |
| [ese_vovnet19b_dw.ra_in1k](<docs/models/ese_vovnet19b_dw.ra_in1k>)                                   | ‚úÖ       | 111 (12)                        | 0 (0)                           | 19                   |                  2004.19 | 17.99                                      | 99.44          |
| [ghostnet_100.in1k](<docs/models/ghostnet_100.in1k>)                                                 | ‚úÖ       | 515 (14)                        | 0 (0)                           | 64                   |                  1516.68 | 36.71                                      | 99.6           |
| [mobilenet_v2](<docs/models/mobilenet_v2>)                                                           | ‚úÖ       | 154 (9)                         | 0 (0)                           | 0                    |                   749.5  | 21.85                                      | 99.09          |
| [mobilenet_v3_large](<docs/models/mobilenet_v3_large>)                                               | ‚úÖ       | 188 (11)                        | 0 (0)                           | 0                    |                   819.26 | 33.17                                      | 99.15          |
| [mobilenet_v3_small](<docs/models/mobilenet_v3_small>)                                               | ‚úÖ       | 158 (11)                        | 0 (0)                           | 0                    |                   810.18 | 22.73                                      | 99.09          |
| [mobilenetv1_100.ra4_e3600_r224_in1k](<docs/models/mobilenetv1_100.ra4_e3600_r224_in1k>)             | ‚úÖ       | 85 (7)                          | 0 (0)                           | 0                    |                  1227.09 | 18.45                                      | 96.04          |
| [regnet_x_16gf](<docs/models/regnet_x_16gf>)                                                         | ‚úÖ       | 235 (8)                         | 0 (0)                           | 0                    |                 14326.6  | 73.53                                      | 99.59          |
| [regnet_x_1_6gf](<docs/models/regnet_x_1_6gf>)                                                       | ‚úÖ       | 195 (8)                         | 0 (0)                           | 0                    |                  1928.56 | 26.58                                      | 99.47          |
| [regnet_x_32gf](<docs/models/regnet_x_32gf>)                                                         | ‚úÖ       | 245 (8)                         | 0 (0)                           | 0                    |                 28695.7  | 124.37                                     | 99.27          |
| [regnet_x_3_2gf](<docs/models/regnet_x_3_2gf>)                                                       | ‚úÖ       | 265 (8)                         | 0 (0)                           | 0                    |                  3420.68 | 32.81                                      | 99.5           |
| [regnet_x_400mf](<docs/models/regnet_x_400mf>)                                                       | ‚úÖ       | 235 (8)                         | 0 (0)                           | 0                    |                  1191.88 | 29.35                                      | 99.66          |
| [regnet_x_800mf](<docs/models/regnet_x_800mf>)                                                       | ‚úÖ       | 175 (8)                         | 0 (0)                           | 0                    |                  1217.26 | 22.35                                      | 99.44          |
| [regnet_x_8gf](<docs/models/regnet_x_8gf>)                                                           | ‚úÖ       | 245 (8)                         | 0 (0)                           | 0                    |                  7497.79 | 51.47                                      | 98.99          |
| [regnet_y_16gf](<docs/models/regnet_y_16gf>)                                                         | ‚úÖ       | 303 (10)                        | 0 (0)                           | 0                    |                 18787.3  | 86.05                                      | 99.66          |
| [regnet_y_1_6gf](<docs/models/regnet_y_1_6gf>)                                                       | ‚úÖ       | 447 (10)                        | 0 (0)                           | 0                    |                  2224.54 | 49.86                                      | 99.69          |
| [regnet_y_32gf](<docs/models/regnet_y_32gf>)                                                         | ‚úÖ       | 335 (10)                        | 0 (0)                           | 0                    |                 36945.2  | 126.75                                     | 99.72          |
| [regnet_y_3_2gf](<docs/models/regnet_y_3_2gf>)                                                       | ‚úÖ       | 351 (10)                        | 0 (0)                           | 0                    |                  3400.24 | 43.68                                      | 99.82          |
| [regnet_y_400mf](<docs/models/regnet_y_400mf>)                                                       | ‚úÖ       | 271 (10)                        | 0 (0)                           | 0                    |                   812.87 | 25.17                                      | 99.64          |
| [regnet_y_800mf](<docs/models/regnet_y_800mf>)                                                       | ‚úÖ       | 239 (10)                        | 0 (0)                           | 0                    |                  1146.71 | 24.18                                      | 99.59          |
| [regnet_y_8gf](<docs/models/regnet_y_8gf>)                                                           | ‚úÖ       | 287 (10)                        | 0 (0)                           | 0                    |                  8521.26 | 58.36                                      | 99.83          |
| [resnet101](<docs/models/resnet101>)                                                                 | ‚úÖ       | 346 (9)                         | 0 (0)                           | 1                    |                  8027.7  | 41.12                                      | 99.25          |
| [resnet152](<docs/models/resnet152>)                                                                 | ‚úÖ       | 516 (9)                         | 0 (0)                           | 1                    |                 11558.4  | 66.64                                      | 99.09          |
| [resnet18](<docs/models/resnet18>)                                                                   | ‚úÖ       | 70 (9)                          | 0 (0)                           | 1                    |                  2369.51 | 11.46                                      | 99.61          |
| [resnet34](<docs/models/resnet34>)                                                                   | ‚úÖ       | 126 (9)                         | 0 (0)                           | 1                    |                  4657.43 | 17.23                                      | 99.07          |
| [resnet50](<docs/models/resnet50>)                                                                   | ‚úÖ       | 176 (9)                         | 0 (0)                           | 1                    |                  4606.2  | 23.31                                      | 98.61          |
| [resnext101_32x8d](<docs/models/resnext101_32x8d>)                                                   | ‚úÖ       | 346 (9)                         | 0 (0)                           | 1                    |                 15649.9  | 120.94                                     | 99.57          |
| [resnext101_64x4d](<docs/models/resnext101_64x4d>)                                                   | ‚úÖ       | 346 (9)                         | 0 (0)                           | 1                    |                 15034.6  | 120.39                                     | 99.65          |
| [resnext50_32x4d](<docs/models/resnext50_32x4d>)                                                     | ‚úÖ       | 176 (9)                         | 0 (0)                           | 1                    |                  4422.85 | 28.83                                      | 99.44          |
| [textattack/albert-base-v2-imdb](<docs/models/textattack/albert-base-v2-imdb>)                       | ‚úÖ       | 782 (22)                        | 0 (0)                           | 2                    |                  1188.64 | 14.79                                      | 100.0          |
| [tf_efficientnet_lite0.in1k](<docs/models/tf_efficientnet_lite0.in1k>)                               | ‚úÖ       | 149 (9)                         | 0 (0)                           | 5                    |                  1179.89 | 34.64                                      | 99.3           |
| [tf_efficientnet_lite1.in1k](<docs/models/tf_efficientnet_lite1.in1k>)                               | ‚úÖ       | 194 (9)                         | 0 (0)                           | 5                    |                  1459.38 | 46.8                                       | 99.56          |
| [tf_efficientnet_lite2.in1k](<docs/models/tf_efficientnet_lite2.in1k>)                               | ‚úÖ       | 194 (9)                         | 0 (0)                           | 5                    |                  2277.51 | 77.49                                      | 99.21          |
| [twmkn9/albert-base-v2-squad2](<docs/models/twmkn9/albert-base-v2-squad2>)                           | ‚úÖ       | 783 (23)                        | 0 (0)                           | 2                    |                  1251.79 | 16.16                                      | 99.86          |
| [vgg11](<docs/models/vgg11>)                                                                         | ‚úÖ       | 33 (8)                          | 0 (0)                           | 5                    |                 11401.2  | 13.17                                      | 99.65          |
| [vgg11_bn](<docs/models/vgg11_bn>)                                                                   | ‚úÖ       | 41 (9)                          | 0 (0)                           | 5                    |                 11545.8  | 13.87                                      | 98.99          |
| [vgg13](<docs/models/vgg13>)                                                                         | ‚úÖ       | 37 (8)                          | 0 (0)                           | 5                    |                 19089.8  | 15.24                                      | 99.38          |
| [vgg13_bn](<docs/models/vgg13_bn>)                                                                   | ‚úÖ       | 47 (9)                          | 0 (0)                           | 5                    |                 16971.5  | 16.34                                      | 97.35          |
| [vgg16](<docs/models/vgg16>)                                                                         | ‚úÖ       | 43 (8)                          | 0 (0)                           | 5                    |                 25633.6  | 20.17                                      | 99.44          |
| [vgg16_bn](<docs/models/vgg16_bn>)                                                                   | ‚úÖ       | 56 (9)                          | 0 (0)                           | 5                    |                 26275.3  | 20.65                                      | 98.38          |
| [vgg19](<docs/models/vgg19>)                                                                         | ‚úÖ       | 49 (8)                          | 0 (0)                           | 5                    |                 31297    | 23.06                                      | 99.27          |
| [vgg19_bn](<docs/models/vgg19_bn>)                                                                   | ‚úÖ       | 65 (9)                          | 0 (0)                           | 5                    |                 31650    | 25.04                                      | 96.97          |
| [wide_resnet101_2](<docs/models/wide_resnet101_2>)                                                   | ‚úÖ       | 346 (9)                         | 0 (0)                           | 1                    |                 22483.9  | 54.25                                      | 99.2           |
| [wide_resnet50_2](<docs/models/wide_resnet50_2>)                                                     | ‚úÖ       | 176 (9)                         | 0 (0)                           | 1                    |                 12283.4  | 29.27                                      | 98.8           |
| [xception71.tf_in1k](<docs/models/xception71.tf_in1k>)                                               | ‚úÖ       | 393 (9)                         | 0 (0)                           | 0                    |                 21627.8  | 246.28                                     | 99.21          |
| [Autoencoder (conv)](<docs/models/Autoencoder (conv)>)                                               | üöß       | 9 (3)                           | 1 (1)                           | 1                    |                  1534.74 | 3.15                                       | 100.0          |
| [Autoencoder (conv)-train](<docs/models/Autoencoder (conv)-train>)                                   | üöß       | 24 (7)                          | 11 (4)                          | 0                    |                  2704.69 | 7.18                                       | 100.0          |
| [Autoencoder (linear)-train](<docs/models/Autoencoder (linear)-train>)                               | üöß       | 104 (8)                         | 14 (2)                          | 0                    |                  2444    | 15.05                                      | 100.0          |
| [Bloom](<docs/models/Bloom>)                                                                         | üöß       | 1405 (27)                       | 2 (2)                           | 0                    |                 26564.4  | 1438.05                                    | 98.86          |
| [CLIP](<docs/models/CLIP>)                                                                           | üöß       | 1397 (30)                       | 7 (6)                           | 2                    |                  7085.44 | 155.41                                     | 99.56          |
| [CLIP-train](<docs/models/CLIP-train>)                                                               | üöß       | 3944 (44)                       | 265 (16)                        | 5                    |                 22015.1  | 2116.66                                    | 100.0          |
| [DETR](<docs/models/DETR>)                                                                           | üöß       | 1663 (42)                       | 9 (6)                           | 3                    |                109700    | 5241.84                                    | 37.71          |
| [DINOv2](<docs/models/DINOv2>)                                                                       | üöß       | 928 (25)                        | 16 (1)                          | 2                    |                 19070.5  | 74.68                                      | 98.99          |
| [Falcon](<docs/models/Falcon>)                                                                       | üöß       | 94 (15)                         | 5 (5)                           | 3                    |                 61700.8  | 35972.49                                   | 100.0          |
| [GLPN-KITTI](<docs/models/GLPN-KITTI>)                                                               | üöß       | 2959 (26)                       | 22 (2)                          | 6                    |                121398    | 59098.9                                    | 99.75          |
| [GPT-2](<docs/models/GPT-2>)                                                                         | üöß       | 745 (29)                        | 2 (2)                           | 2                    |                  2382.04 | 30.76                                      | 99.98          |
| [HardNet-train](<docs/models/HardNet-train>)                                                         | üöß       | 867 (21)                        | 412 (9)                         | 120                  |                 12086    | 8112.91                                    | 100.0          |
| [MLPMixer-train](<docs/models/MLPMixer-train>)                                                       | üöß       | 616 (19)                        | 100 (5)                         | 0                    |                 15372.3  | 8055.29                                    | 100.0          |
| [Mnist-train](<docs/models/Mnist-train>)                                                             | üöß       | 46 (15)                         | 10 (6)                          | 0                    |                  2927.84 | 32.75                                      | 100.0          |
| [MobileNetSSD](<docs/models/MobileNetSSD>)                                                           | üöß       | 447 (28)                        | 5 (2)                           | 32                   |                   772.15 | 1656.0                                     | 38.39          |
| [OpenPose V2-train](<docs/models/OpenPose V2-train>)                                                 | üöß       | 523 (14)                        | 246 (7)                         | 6                    |                  9643.71 | 6769.66                                    | 100.0          |
| [ResNet18-train](<docs/models/ResNet18-train>)                                                       | üöß       | 241 (19)                        | 121 (9)                         | 0                    |                  5928.13 | 4373.7                                     | 100.0          |
| [ResNet50-train](<docs/models/ResNet50-train>)                                                       | üöß       | 616 (19)                        | 318 (9)                         | 0                    |                 14491    | 10943.79                                   | 100.0          |
| [SegFormer](<docs/models/SegFormer>)                                                                 | üöß       | 676 (22)                        | 16 (1)                          | 4                    |                 26213.1  | 379.98                                     | 99.85          |
| [SegFormer-train](<docs/models/SegFormer-train>)                                                     | üöß       | 1794 (36)                       | 156 (12)                        | 4                    |                 56013.5  | 21994.44                                   | 100.0          |
| [Stable Diffusion V2](<docs/models/Stable Diffusion V2>)                                             | üöß       | 29 (14)                         | 11 (5)                          | 4                    |                749457    | 738179.63                                  | 99.97          |
| [U-Net-train](<docs/models/U-Net-train>)                                                             | üöß       | 236 (15)                        | 122 (8)                         | 8                    |                 78929    | 39867.88                                   | 100.0          |
| [Unet-brain-train](<docs/models/Unet-brain-train>)                                                   | üöß       | 236 (15)                        | 122 (8)                         | 8                    |                109651    | 48069.8                                    | 100.0          |
| [Unet-carvana-train](<docs/models/Unet-carvana-train>)                                               | üöß       | 232 (13)                        | 121 (7)                         | 8                    |                142285    | 79170.54                                   | 100.0          |
| [ViLT](<docs/models/ViLT>)                                                                           | üöß       | 42 (16)                         | 5 (4)                           | 3                    |                 14304.7  | 11955.32                                   | 87.94          |
| [YOLOS](<docs/models/YOLOS>)                                                                         | üöß       | 952 (27)                        | 17 (2)                          | 2                    |                 14700.2  | 279.66                                     | 98.6           |
| [YOLOv3](<docs/models/YOLOv3>)                                                                       | üöß       | 250 (7)                         | 2 (1)                           | 4                    |                156567    | 61.9                                       | 98.63          |
| [albert/albert-xxlarge-v2](<docs/models/albert/albert-xxlarge-v2>)                                   | üöß       | 791 (21)                        | 24 (1)                          | 3                    |                 15830.8  | 148.11                                     | 98.54          |
| [dla34.in1k-train](<docs/models/dla34.in1k-train>)                                                   | üöß       | 469 (18)                        | 230 (8)                         | 17                   |                 10257.1  | 7052.55                                    | 100.0          |
| [ese_vovnet19b_dw.ra_in1k-train](<docs/models/ese_vovnet19b_dw.ra_in1k-train>)                       | üöß       | 383 (25)                        | 176 (10)                        | 16                   |                  5523.09 | 3444.04                                    | 100.0          |
| [facebook/deit-base-patch16-224](<docs/models/facebook/deit-base-patch16-224>)                       | üöß       | 685 (17)                        | 1 (1)                           | 1                    |                 15432.1  | 116.17                                     | 98.34          |
| [facebook/deit-base-patch16-224-train](<docs/models/facebook/deit-base-patch16-224-train>)           | üöß       | 1854 (27)                       | 127 (8)                         | 2                    |                 74557    | 1529.14                                    | 100.0          |
| [ghostnet_100.in1k-train](<docs/models/ghostnet_100.in1k-train>)                                     | üöß       | 1469 (33)                       | 562 (12)                        | 64                   |                  1597.56 | 2208.1                                     | 100.0          |
| [ghostnetv2_100.in1k](<docs/models/ghostnetv2_100.in1k>)                                             | üöß       | 683 (18)                        | 24 (2)                          | 68                   |                  1433.62 | 108.13                                     | 99.65          |
| [ghostnetv2_100.in1k-train](<docs/models/ghostnetv2_100.in1k-train>)                                 | üöß       | 2001 (39)                       | 852 (17)                        | 68                   |                  2286.93 | 4583.84                                    | 100.0          |
| [googlenet](<docs/models/googlenet>)                                                                 | üöß       | 214 (15)                        | 1 (1)                           | 51                   |                  2140.65 | 28.35                                      | 99.67          |
| [hrnet_w18.ms_aug_in1k](<docs/models/hrnet_w18.ms_aug_in1k>)                                         | üöß       | 1209 (11)                       | 31 (1)                          | 0                    |                  6048.71 | 189.3                                      | 99.62          |
| [hrnet_w18.ms_aug_in1k-train](<docs/models/hrnet_w18.ms_aug_in1k-train>)                             | üöß       | 3998 (21)                       | 1973 (9)                        | 0                    |                 12822    | 9284.62                                    | 100.0          |
| [inception_v4.tf_in1k](<docs/models/inception_v4.tf_in1k>)                                           | üöß       | 495 (11)                        | 14 (1)                          | 84                   |                 11513.3  | 164.6                                      | 99.11          |
| [inception_v4.tf_in1k-train](<docs/models/inception_v4.tf_in1k-train>)                               | üöß       | 1851 (24)                       | 932 (11)                        | 80                   |                 38761.7  | 27517.2                                    | 100.0          |
| [mixer_b16_224.goog_in21k](<docs/models/mixer_b16_224.goog_in21k>)                                   | üöß       | 356 (11)                        | 1 (1)                           | 0                    |                 12636.3  | 103.93                                     | 3.65           |
| [mixer_b16_224.goog_in21k-train](<docs/models/mixer_b16_224.goog_in21k-train>)                       | üöß       | 959 (18)                        | 101 (6)                         | 0                    |                 55346.5  | 1584.84                                    | 100.0          |
| [mobilenetv1_100.ra4_e3600_r224_in1k-train](<docs/models/mobilenetv1_100.ra4_e3600_r224_in1k-train>) | üöß       | 258 (16)                        | 164 (7)                         | 0                    |                  2880.5  | 2830.62                                    | 100.0          |
| [regnet_y_128gf](<docs/models/regnet_y_128gf>)                                                       | üöß       | 447 (10)                        | 3 (1)                           | 0                    |                574740    | 61537.91                                   | 98.91          |
| [ssd300_vgg16](<docs/models/ssd300_vgg16>)                                                           | üöß       | 251 (26)                        | 6 (3)                           | 37                   |                  3501.82 | 1620.55                                    | N/A            |
| [ssdlite320_mobilenet_v3_large](<docs/models/ssdlite320_mobilenet_v3_large>)                         | üöß       | 447 (28)                        | 5 (2)                           | 32                   |                   588.44 | 2201.52                                    | 46.25          |
| [swin_b](<docs/models/swin_b>)                                                                       | üöß       | 2492 (32)                       | 110 (2)                         | 479                  |                 14871.7  | 271.48                                     | 92.77          |
| [swin_s](<docs/models/swin_s>)                                                                       | üöß       | 2492 (32)                       | 110 (2)                         | 479                  |                  7259.52 | 219.15                                     | 91.71          |
| [swin_t](<docs/models/swin_t>)                                                                       | üöß       | 1238 (32)                       | 50 (2)                          | 227                  |                  3969.8  | 119.19                                     | 96.62          |
| [swin_v2_b](<docs/models/swin_v2_b>)                                                                 | üöß       | 3140 (40)                       | 158 (3)                         | 473                  |                 18455    | 404.08                                     | 13.6           |
| [swin_v2_s](<docs/models/swin_v2_s>)                                                                 | üöß       | 3140 (40)                       | 158 (3)                         | 473                  |                 10728.6  | 354.55                                     | 31.41          |
| [swin_v2_t](<docs/models/swin_v2_t>)                                                                 | üöß       | 1562 (40)                       | 74 (3)                          | 221                  |                  5781.82 | 206.17                                     | 44.1           |
| [tf_efficientnet_lite0.in1k-train](<docs/models/tf_efficientnet_lite0.in1k-train>)                   | üöß       | 452 (17)                        | 285 (8)                         | 5                    |                  2193.16 | 5735.06                                    | 100.0          |
| [tf_efficientnet_lite1.in1k-train](<docs/models/tf_efficientnet_lite1.in1k-train>)                   | üöß       | 587 (17)                        | 370 (8)                         | 5                    |                  4023.01 | 10279.59                                   | 100.0          |
| [tf_efficientnet_lite2.in1k-train](<docs/models/tf_efficientnet_lite2.in1k-train>)                   | üöß       | 587 (17)                        | 370 (8)                         | 5                    |                  4492.05 | 13217.98                                   | 100.0          |
| [tf_efficientnet_lite3.in1k](<docs/models/tf_efficientnet_lite3.in1k>)                               | üöß       | 221 (9)                         | 5 (1)                           | 5                    |                  2369.2  | 285.18                                     | 99.15          |
| [tf_efficientnet_lite3.in1k-train](<docs/models/tf_efficientnet_lite3.in1k-train>)                   | üöß       | 668 (17)                        | 426 (9)                         | 5                    |                  7241.47 | 18502.16                                   | 100.0          |
| [tf_efficientnet_lite4.in1k](<docs/models/tf_efficientnet_lite4.in1k>)                               | üöß       | 275 (9)                         | 6 (1)                           | 5                    |                  4867.85 | 493.93                                     | 99.21          |
| [tf_efficientnet_lite4.in1k-train](<docs/models/tf_efficientnet_lite4.in1k-train>)                   | üöß       | 830 (17)                        | 529 (9)                         | 5                    |                 16663    | 54479.52                                   | 100.0          |
| [vit_b_16](<docs/models/vit_b_16>)                                                                   | üöß       | 552 (17)                        | 1 (1)                           | 1                    |                 13083.2  | 155.42                                     | 99.54          |
| [vit_b_32](<docs/models/vit_b_32>)                                                                   | üöß       | 552 (17)                        | 1 (1)                           | 1                    |                  4595.81 | 136.95                                     | 98.68          |
| [vit_h_14](<docs/models/vit_h_14>)                                                                   | üöß       | 1452 (17)                       | 1 (1)                           | 1                    |                776553    | 2666.36                                    | 98.59          |
| [vit_l_16](<docs/models/vit_l_16>)                                                                   | üöß       | 1092 (17)                       | 1 (1)                           | 1                    |                 44007    | 278.76                                     | 99.74          |
| [vit_l_32](<docs/models/vit_l_32>)                                                                   | üöß       | 1092 (17)                       | 1 (1)                           | 1                    |                 17724.1  | 208.63                                     | 98.97          |
| [xception71.tf_in1k-train](<docs/models/xception71.tf_in1k-train>)                                   | üöß       | 1378 (18)                       | 806 (7)                         | 0                    |                 58453.2  | 58573.31                                   | 100.0          |
| [FLAN-T5](<docs/models/FLAN-T5>)                                                                     | ‚ùå       | 20020 (38)                      | N/A                             | N/A                  |                  3539.34 | N/A                                        | N/A            |
| [GPTNeo](<docs/models/GPTNeo>)                                                                       | ‚ùå       | 2733 (35)                       | N/A                             | N/A                  |                 10366    | N/A                                        | N/A            |
| [OPT](<docs/models/OPT>)                                                                             | ‚ùå       | 4003 (32)                       | N/A                             | N/A                  |                 25126.5  | N/A                                        | N/A            |
| [Whisper](<docs/models/Whisper>)                                                                     | ‚ùå       | 4310 (21)                       | N/A                             | N/A                  |                242249    | N/A                                        | N/A            |
| [codegen](<docs/models/codegen>)                                                                     | ‚ùå       | 9183 (37)                       | N/A                             | N/A                  |                  7646.91 | N/A                                        | N/A            |
| [densenet201](<docs/models/densenet201>)                                                             | ‚ùå       | 712 (10)                        | N/A                             | N/A                  |                  4291.31 | N/A                                        | N/A            |
| [speecht5-tts](<docs/models/speecht5-tts>)                                                           | ‚ùå       | 6942 (40)                       | N/A                             | N/A                  |                 49870    | N/A                                        | N/A            |
| [t5-base](<docs/models/t5-base>)                                                                     | ‚ùå       | 14681 (38)                      | N/A                             | N/A                  |                  4794.11 | N/A                                        | N/A            |
| [t5-large](<docs/models/t5-large>)                                                                   | ‚ùå       | 22696 (38)                      | N/A                             | N/A                  |                 12239.2  | N/A                                        | N/A            |
| [t5-small](<docs/models/t5-small>)                                                                   | ‚ùå       | 6118 (38)                       | N/A                             | N/A                  |                  2059.99 | N/A                                        | N/A            |

### Explanation of Metrics

**Model**: Name of the model.  
**Status**: Indicates whether the model is ‚ùå traced / üöß compiled / ‚úÖ E2E on device.  
**Torch Ops Before (Unique Ops)**: The total number of operations used by the model in the original Torch implementation. The number in parenthesis represents the total unique ops.  
**Torch Ops Remain (Unique Ops)**: The total number of operations used after conversion to TTNN. The number in parenthesis represents the total unique ops.  
**To/From Device Ops**: The number of `to/from_device` operations (data transfer to/from the device).  
**Original Run Time (ms)**: Execution time (in seconds) of the model before conversion.  
**Compiled Run Time for 5th Iteration (ms)**: Execution time (in seconds) of the model after conversion for the 5th iteration.  
**Accuracy (%)**: Model accuracy on a predefined test dataset after conversion.  

***

## Quickstart

The `torch_ttnn` module has a `backend` function, which can be used with the `torch.compile()`.

```python
import torch
import torch_ttnn

# A torch Module
class FooModule(torch.nn.Module):
    ...
# Create a module
module = FooModule()

# Compile the module, with ttnn backend
device = ttnn.open_device(device_id=0)
option = torch_ttnn.TorchTtnnOption(device=self.device)
ttnn_module = torch.compile(module, backend=torch_ttnn.backend, options=option)

# Running inference / training
ttnn_module(input_data)
```

## Tracer
The tracer dump the information of fx graph such as node's op_name and shape.

For example, you can run this script to parse the information
```
PYTHONPATH=$(pwd) python3 tools/stat_models.py --trace_orig --backward --profile
ls stat/raw
```

By default, the raw result will be stored at `stat/raw`, and you can run this script to generate the report
```
python3 tools/generate_report.py
ls stat/
```
Now the `stat/` folder have these report
 - `fw_node_count.csv`
 - `bw_node_count.csv`
 - `fw_total_input_size_dist/`
 - `bw_total_input_size_dist/`
 - `fw_total_output_size_dist/`
 - `bw_total_output_size_dist/`
 - `profile/`

The `node_count.csv` show the node with `op_type` appear in the fx graph. This report can help analyze the frequency of op type appear in the graph.

The `*_total_*_size_dist/` statistics the `op_type`'s input/output_size distribution from all fx graph recored in `stat/raw`. This report can help analyze the memory footprint durning the calculation of `op_type`.

 - Notice: the default `input_shapes` in `tools/stat_torchvision.py` is `[1,3,224,224]`, which has dependency with `*_total_*_size_dist/` report.

 - Notice: the [aten ir interface is in there](https://pytorch.org/docs/stable/torch.compiler_ir.html)

[The `profile/` is the tools provided by pytorch](https://pytorch.org/tutorials/recipes/recipes/profiler_recipe.html), you can open it by the url: chrome://tracing


# For developers

## Install torch-ttnn with editable mode

During development, you may want to use the torch-ttnn package for testing.
In order to do that, you can install the torch-ttnn package in "editable"
mode with

```shell
pip install -e .
```

Now, you can utilize `torch_ttnn` in your Python code. Any modifications you make to the `torch_ttnn` package will take effect immediately, eliminating the need for constant reinstallation via pip.

## Build wheel file

For developers want to deploy the wheel, you can build the wheel file with

```shell
python -m build
```

Then you can upload the `.whl` file to the PyPI (Python Package Index).

## Run transformer models
To run transformer model with ttnn backend, run:
```
PYTHONPATH="$TT_METAL_HOME:$(pwd)" python3 tools/run_transformers.py --model "phiyodr/bert-large-finetuned-squad2" --backend torch_ttnn
```

You can also substitute the backend with `torch_stat` to run a reference comparison.

