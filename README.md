[comment]: <> (This README.md was generated by tools/collect_metrics.py.)
[comment]: <> (Please modify docs/README.md.in and/or collect_metrics.py to make permanent changes.)

# PyTorch 2.0 TTNN Compiler
This project allows to run PyTorch code on [Tenstorrent](https://tenstorrent.com/) hardware.

## Supported Models

The table below summarizes the results of running various ML models through our TTNN compiler. For each model, we track whether the run was successful, the number of operations before and after conversion, the number of `to_device` and `from_device` operations, performance metrics, and accuracy.

| Model                                                                                              | Run Success   | Torch Ops Before (Unique Ops)   | Torch Ops Remain (Unique Ops)   | To/From Device Ops   |   Original Run Time (ms) | Compiled Run Time (ms)   | Accuracy (%)   |
|:---------------------------------------------------------------------------------------------------|:--------------|:--------------------------------|:--------------------------------|:---------------------|-------------------------:|:-------------------------|:---------------|
| [Autoencoder (conv) eval](<docs/models/Autoencoder (conv) eval>)                                   | ✘             | 9 (3)                           | N/A                             | N/A                  |                  1987.15 | N/A                      | N/A            |
| [Autoencoder (linear) eval](<docs/models/Autoencoder (linear) eval>)                               | ✘             | 22 (3)                          | N/A                             | N/A                  |                  1261.22 | N/A                      | N/A            |
| [BERT eval](<docs/models/BERT eval>)                                                               | ✅            | 1393 (21)                       | 0 (0)                           | 28                   |                 90541.6  | 53588.1                  | 98.88          |
| [Bloom eval](<docs/models/Bloom eval>)                                                             | ✅            | 1407 (29)                       | 77 (6)                          | 74                   |                 49758.7  | 60006.68                 | 33.26          |
| [CLIP eval](<docs/models/CLIP eval>)                                                               | ✘             | 1397 (30)                       | N/A                             | N/A                  |                 10903.1  | N/A                      | N/A            |
| [DETR eval](<docs/models/DETR eval>)                                                               | ✘             | 1667 (41)                       | N/A                             | N/A                  |                  2936.29 | N/A                      | N/A            |
| [DPR eval](<docs/models/DPR eval>)                                                                 | ✘             | 720 (22)                        | N/A                             | N/A                  |                  4438.19 | N/A                      | N/A            |
| [FLAN-T5 eval](<docs/models/FLAN-T5 eval>)                                                         | ✘             | N/A                             | N/A                             | N/A                  |                  4382.63 | N/A                      | N/A            |
| [Falcon eval](<docs/models/Falcon eval>)                                                           | ✘             | 2698 (30)                       | N/A                             | N/A                  |                131265    | N/A                      | N/A            |
| [GLPN-KITTI eval](<docs/models/GLPN-KITTI eval>)                                                   | ✘             | 3064 (30)                       | N/A                             | N/A                  |                  5463.94 | N/A                      | N/A            |
| [GPT-2 eval](<docs/models/GPT-2 eval>)                                                             | ✘             | 748 (31)                        | N/A                             | N/A                  |                 17860    | N/A                      | N/A            |
| [GPTNeo eval](<docs/models/GPTNeo eval>)                                                           | ✘             | N/A                             | N/A                             | N/A                  |                  9503.56 | N/A                      | N/A            |
| [Hand Landmark eval](<docs/models/Hand Landmark eval>)                                             | ✘             | N/A                             | N/A                             | N/A                  |                  8368.55 | N/A                      | N/A            |
| [HardNet eval](<docs/models/HardNet eval>)                                                         | ✅            | 245 (10)                        | 240 (5)                         | 1                    |                   933.59 | 16210.73                 | 99.99          |
| [Llama eval](<docs/models/Llama eval>)                                                             | ✅            | 104 (5)                         | 33 (2)                          | 35                   |                339164    | 225314.21                | 100.0          |
| [MLPMixer eval](<docs/models/MLPMixer eval>)                                                       | ✘             | 253 (11)                        | N/A                             | N/A                  |                   218.05 | N/A                      | N/A            |
| [Mnist eval](<docs/models/Mnist eval>)                                                             | ✅            | 14 (8)                          | 3 (2)                           | 3                    |                    30.01 | 431.97                   | 99.42          |
| [Mnist train](<docs/models/Mnist train>)                                                           | ✅            | 46 (15)                         | 20 (8)                          | 14                   |                  3703.92 | 10540.23                 | 100.0          |
| [MobileNetSSD eval](<docs/models/MobileNetSSD eval>)                                               | ✘             | 575 (34)                        | N/A                             | N/A                  |                   558.35 | N/A                      | N/A            |
| [MobileNetV2 eval](<docs/models/MobileNetV2 eval>)                                                 | ✘             | 154 (9)                         | N/A                             | N/A                  |                   373.9  | N/A                      | N/A            |
| [OPT eval](<docs/models/OPT eval>)                                                                 | ✘             | N/A                             | N/A                             | N/A                  |                  9490.02 | N/A                      | N/A            |
| [OpenPose V2 eval](<docs/models/OpenPose V2 eval>)                                                 | ✘             | 155 (7)                         | N/A                             | N/A                  |                  1223    | N/A                      | N/A            |
| [Perceiver IO eval](<docs/models/Perceiver IO eval>)                                               | ✘             | 1532 (21)                       | N/A                             | N/A                  |                  7288.87 | N/A                      | N/A            |
| [ResNet18 eval](<docs/models/ResNet18 eval>)                                                       | ✅            | 70 (9)                          | 41 (3)                          | 17                   |                  1958.23 | 11305.13                 | 99.99          |
| [ResNet50 eval](<docs/models/ResNet50 eval>)                                                       | ✅            | 176 (9)                         | 107 (3)                         | 49                   |                  4192.6  | 15258.2                  | 99.98          |
| [RoBERTa eval](<docs/models/RoBERTa eval>)                                                         | ✘             | 719 (21)                        | N/A                             | N/A                  |                 12081.9  | N/A                      | N/A            |
| [SegFormer eval](<docs/models/SegFormer eval>)                                                     | ✘             | 760 (27)                        | N/A                             | N/A                  |                  1188.27 | N/A                      | N/A            |
| [SqueezeBERT eval](<docs/models/SqueezeBERT eval>)                                                 | ✅            | 16 (9)                          | 4 (2)                           | 4                    |                  2756.38 | 9907.21                  | 100.0          |
| [Stable Diffusion V2 eval](<docs/models/Stable Diffusion V2 eval>)                                 | ✘             | 1762 (29)                       | N/A                             | N/A                  |                 40571.4  | N/A                      | N/A            |
| [U-Net eval](<docs/models/U-Net eval>)                                                             | ✘             | 68 (6)                          | N/A                             | N/A                  |                   850.31 | N/A                      | N/A            |
| [Unet-brain eval](<docs/models/Unet-brain eval>)                                                   | ✘             | 68 (6)                          | N/A                             | N/A                  |                   646.49 | N/A                      | N/A            |
| [Unet-carvana eval](<docs/models/Unet-carvana eval>)                                               | ✘             | 67 (5)                          | N/A                             | N/A                  |                   658.58 | N/A                      | N/A            |
| [ViLT eval](<docs/models/ViLT eval>)                                                               | ✘             | 781 (30)                        | N/A                             | N/A                  |                  5942.99 | N/A                      | N/A            |
| [Whisper eval](<docs/models/Whisper eval>)                                                         | ✘             | N/A                             | N/A                             | N/A                  |                 17891.6  | N/A                      | N/A            |
| [XGLM eval](<docs/models/XGLM eval>)                                                               | ✘             | 1458 (30)                       | N/A                             | N/A                  |                 12587.4  | N/A                      | N/A            |
| [YOLOS eval](<docs/models/YOLOS eval>)                                                             | ✅            | 964 (28)                        | 50 (8)                          | 33                   |                  1701    | 59405.53                 | 42.2           |
| [YOLOv3 eval](<docs/models/YOLOv3 eval>)                                                           | ✘             | 264 (10)                        | N/A                             | N/A                  |                 26433.3  | N/A                      | N/A            |
| [YOLOv5 eval](<docs/models/YOLOv5 eval>)                                                           | ✘             | 236 (13)                        | N/A                             | N/A                  |                  9854.37 | N/A                      | N/A            |
| [albert/albert-base-v2 eval](<docs/models/albert/albert-base-v2 eval>)                             | ✘             | 791 (21)                        | N/A                             | N/A                  |                  1562.01 | N/A                      | N/A            |
| [albert/albert-large-v2 eval](<docs/models/albert/albert-large-v2 eval>)                           | ✘             | 1547 (21)                       | N/A                             | N/A                  |                  1813.08 | N/A                      | N/A            |
| [albert/albert-xlarge-v2 eval](<docs/models/albert/albert-xlarge-v2 eval>)                         | ✘             | 1547 (21)                       | N/A                             | N/A                  |                  3150.21 | N/A                      | N/A            |
| [albert/albert-xxlarge-v2 eval](<docs/models/albert/albert-xxlarge-v2 eval>)                       | ✘             | 791 (21)                        | N/A                             | N/A                  |                  8380.85 | N/A                      | N/A            |
| [codegen eval](<docs/models/codegen eval>)                                                         | ✘             | N/A                             | N/A                             | N/A                  |                  9008.77 | N/A                      | N/A            |
| [densenet121 eval](<docs/models/densenet121 eval>)                                                 | ✘             | 432 (10)                        | N/A                             | N/A                  |                   652.81 | N/A                      | N/A            |
| [densenet161 eval](<docs/models/densenet161 eval>)                                                 | ✘             | 572 (10)                        | N/A                             | N/A                  |                  1070.68 | N/A                      | N/A            |
| [densenet169 eval](<docs/models/densenet169 eval>)                                                 | ✘             | 600 (10)                        | N/A                             | N/A                  |                   700.67 | N/A                      | N/A            |
| [densenet201 eval](<docs/models/densenet201 eval>)                                                 | ✘             | 712 (10)                        | N/A                             | N/A                  |                   960.83 | N/A                      | N/A            |
| [distilbert-base-uncased eval](<docs/models/distilbert-base-uncased eval>)                         | ✘             | 367 (17)                        | N/A                             | N/A                  |                  3497.18 | N/A                      | N/A            |
| [dla34.in1k eval](<docs/models/dla34.in1k eval>)                                                   | ✘             | 135 (9)                         | N/A                             | N/A                  |                  4161.93 | N/A                      | N/A            |
| [ese_vovnet19b_dw.ra_in1k eval](<docs/models/ese_vovnet19b_dw.ra_in1k eval>)                       | ✘             | 111 (12)                        | N/A                             | N/A                  |                  1542.26 | N/A                      | N/A            |
| [facebook/deit-base-patch16-224 eval](<docs/models/facebook/deit-base-patch16-224 eval>)           | ✅            | 685 (17)                        | 15 (4)                          | 16                   |                  3616.52 | 36212.56                 | 96.77          |
| [ghostnet_100.in1k eval](<docs/models/ghostnet_100.in1k eval>)                                     | ✘             | 515 (14)                        | N/A                             | N/A                  |                   711    | N/A                      | N/A            |
| [ghostnetv2_100.in1k eval](<docs/models/ghostnetv2_100.in1k eval>)                                 | ✘             | 781 (20)                        | N/A                             | N/A                  |                  1286.38 | N/A                      | N/A            |
| [googlenet eval](<docs/models/googlenet eval>)                                                     | ✘             | 214 (15)                        | N/A                             | N/A                  |                   549.2  | N/A                      | N/A            |
| [hrnet_w18.ms_aug_in1k eval](<docs/models/hrnet_w18.ms_aug_in1k eval>)                             | ✘             | 1426 (14)                       | N/A                             | N/A                  |                  2252.77 | N/A                      | N/A            |
| [inception_v4.tf_in1k eval](<docs/models/inception_v4.tf_in1k eval>)                               | ✘             | 495 (11)                        | N/A                             | N/A                  |                  2169.95 | N/A                      | N/A            |
| [microsoft/beit-base-patch16-224 eval](<docs/models/microsoft/beit-base-patch16-224 eval>)         | ✘             | 793 (21)                        | N/A                             | N/A                  |                  3528.2  | N/A                      | N/A            |
| [microsoft/beit-large-patch16-224 eval](<docs/models/microsoft/beit-large-patch16-224 eval>)       | ✘             | 1573 (21)                       | N/A                             | N/A                  |                  9985.84 | N/A                      | N/A            |
| [mixer_b16_224.goog_in21k eval](<docs/models/mixer_b16_224.goog_in21k eval>)                       | ✅            | 356 (11)                        | 1 (1)                           | 26                   |                  3688.38 | 27370.81                 | 53.1           |
| [mobilenet_v2 eval](<docs/models/mobilenet_v2 eval>)                                               | ✘             | 154 (9)                         | N/A                             | N/A                  |                   500.5  | N/A                      | N/A            |
| [mobilenet_v3_large eval](<docs/models/mobilenet_v3_large eval>)                                   | ✘             | 188 (11)                        | N/A                             | N/A                  |                   444.91 | N/A                      | N/A            |
| [mobilenet_v3_small eval](<docs/models/mobilenet_v3_small eval>)                                   | ✘             | 158 (11)                        | N/A                             | N/A                  |                   336.15 | N/A                      | N/A            |
| [mobilenetv1_100.ra4_e3600_r224_in1k eval](<docs/models/mobilenetv1_100.ra4_e3600_r224_in1k eval>) | ✅            | 85 (7)                          | 81 (3)                          | 1                    |                   665.92 | 7714.06                  | 99.14          |
| [regnet_x_16gf eval](<docs/models/regnet_x_16gf eval>)                                             | ✘             | 235 (8)                         | N/A                             | N/A                  |                  1432.28 | N/A                      | N/A            |
| [regnet_x_1_6gf eval](<docs/models/regnet_x_1_6gf eval>)                                           | ✘             | 195 (8)                         | N/A                             | N/A                  |                   558.7  | N/A                      | N/A            |
| [regnet_x_32gf eval](<docs/models/regnet_x_32gf eval>)                                             | ✘             | 245 (8)                         | N/A                             | N/A                  |                  2725.45 | N/A                      | N/A            |
| [regnet_x_3_2gf eval](<docs/models/regnet_x_3_2gf eval>)                                           | ✘             | 265 (8)                         | N/A                             | N/A                  |                   668.9  | N/A                      | N/A            |
| [regnet_x_400mf eval](<docs/models/regnet_x_400mf eval>)                                           | ✘             | 235 (8)                         | N/A                             | N/A                  |                   486.61 | N/A                      | N/A            |
| [regnet_x_800mf eval](<docs/models/regnet_x_800mf eval>)                                           | ✘             | 175 (8)                         | N/A                             | N/A                  |                   468.61 | N/A                      | N/A            |
| [regnet_x_8gf eval](<docs/models/regnet_x_8gf eval>)                                               | ✘             | 245 (8)                         | N/A                             | N/A                  |                  1163.34 | N/A                      | N/A            |
| [regnet_y_128gf eval](<docs/models/regnet_y_128gf eval>)                                           | ✘             | 447 (10)                        | N/A                             | N/A                  |                 14461.1  | N/A                      | N/A            |
| [regnet_y_16gf eval](<docs/models/regnet_y_16gf eval>)                                             | ✘             | 303 (10)                        | N/A                             | N/A                  |                  2067.55 | N/A                      | N/A            |
| [regnet_y_1_6gf eval](<docs/models/regnet_y_1_6gf eval>)                                           | ✘             | 447 (10)                        | N/A                             | N/A                  |                   615.6  | N/A                      | N/A            |
| [regnet_y_32gf eval](<docs/models/regnet_y_32gf eval>)                                             | ✘             | 335 (10)                        | N/A                             | N/A                  |                  3471.42 | N/A                      | N/A            |
| [regnet_y_3_2gf eval](<docs/models/regnet_y_3_2gf eval>)                                           | ✘             | 351 (10)                        | N/A                             | N/A                  |                   758.2  | N/A                      | N/A            |
| [regnet_y_400mf eval](<docs/models/regnet_y_400mf eval>)                                           | ✘             | 271 (10)                        | N/A                             | N/A                  |                   427.58 | N/A                      | N/A            |
| [regnet_y_800mf eval](<docs/models/regnet_y_800mf eval>)                                           | ✘             | 239 (10)                        | N/A                             | N/A                  |                   460.07 | N/A                      | N/A            |
| [regnet_y_8gf eval](<docs/models/regnet_y_8gf eval>)                                               | ✘             | 287 (10)                        | N/A                             | N/A                  |                  1202.85 | N/A                      | N/A            |
| [resnet101 eval](<docs/models/resnet101 eval>)                                                     | ✘             | 346 (9)                         | N/A                             | N/A                  |                  1262.28 | N/A                      | N/A            |
| [resnet152 eval](<docs/models/resnet152 eval>)                                                     | ✘             | 516 (9)                         | N/A                             | N/A                  |                  1699.56 | N/A                      | N/A            |
| [resnet18 eval](<docs/models/resnet18 eval>)                                                       | ✘             | 70 (9)                          | N/A                             | N/A                  |                   493.51 | N/A                      | N/A            |
| [resnet34 eval](<docs/models/resnet34 eval>)                                                       | ✘             | 126 (9)                         | N/A                             | N/A                  |                   696.66 | N/A                      | N/A            |
| [resnet50 eval](<docs/models/resnet50 eval>)                                                       | ✘             | 176 (9)                         | N/A                             | N/A                  |                   740.61 | N/A                      | N/A            |
| [resnext101_32x8d eval](<docs/models/resnext101_32x8d eval>)                                       | ✘             | 346 (9)                         | N/A                             | N/A                  |                  2072.09 | N/A                      | N/A            |
| [resnext101_64x4d eval](<docs/models/resnext101_64x4d eval>)                                       | ✘             | 346 (9)                         | N/A                             | N/A                  |                  1913.9  | N/A                      | N/A            |
| [resnext50_32x4d eval](<docs/models/resnext50_32x4d eval>)                                         | ✘             | 176 (9)                         | N/A                             | N/A                  |                   790.37 | N/A                      | N/A            |
| [retinanet_resnet50_fpn eval](<docs/models/retinanet_resnet50_fpn eval>)                           | ✘             | 1107 (32)                       | N/A                             | N/A                  |                  2968.32 | N/A                      | N/A            |
| [retinanet_resnet50_fpn_v2 eval](<docs/models/retinanet_resnet50_fpn_v2 eval>)                     | ✘             | 617 (33)                        | N/A                             | N/A                  |                  2884.36 | N/A                      | N/A            |
| [speecht5-tts eval](<docs/models/speecht5-tts eval>)                                               | ✘             | N/A                             | N/A                             | N/A                  |                  7663    | N/A                      | N/A            |
| [ssd300_vgg16 eval](<docs/models/ssd300_vgg16 eval>)                                               | ✘             | 387 (32)                        | N/A                             | N/A                  |                  3501.75 | N/A                      | N/A            |
| [ssdlite320_mobilenet_v3_large eval](<docs/models/ssdlite320_mobilenet_v3_large eval>)             | ✘             | 575 (34)                        | N/A                             | N/A                  |                   587.42 | N/A                      | N/A            |
| [swin_b eval](<docs/models/swin_b eval>)                                                           | ✘             | 1898 (30)                       | N/A                             | N/A                  |                  2527.67 | N/A                      | N/A            |
| [swin_s eval](<docs/models/swin_s eval>)                                                           | ✘             | 1898 (30)                       | N/A                             | N/A                  |                  1652.44 | N/A                      | N/A            |
| [swin_t eval](<docs/models/swin_t eval>)                                                           | ✘             | 968 (30)                        | N/A                             | N/A                  |                  1011.15 | N/A                      | N/A            |
| [swin_v2_b eval](<docs/models/swin_v2_b eval>)                                                     | ✘             | 2474 (37)                       | N/A                             | N/A                  |                  3054.57 | N/A                      | N/A            |
| [swin_v2_s eval](<docs/models/swin_v2_s eval>)                                                     | ✘             | 2474 (37)                       | N/A                             | N/A                  |                  2430.79 | N/A                      | N/A            |
| [swin_v2_t eval](<docs/models/swin_v2_t eval>)                                                     | ✘             | 1256 (37)                       | N/A                             | N/A                  |                  1311.03 | N/A                      | N/A            |
| [t5-base eval](<docs/models/t5-base eval>)                                                         | ✘             | N/A                             | N/A                             | N/A                  |                  6364.17 | N/A                      | N/A            |
| [t5-large eval](<docs/models/t5-large eval>)                                                       | ✘             | N/A                             | N/A                             | N/A                  |                 24510.7  | N/A                      | N/A            |
| [t5-small eval](<docs/models/t5-small eval>)                                                       | ✘             | N/A                             | N/A                             | N/A                  |                  3374.59 | N/A                      | N/A            |
| [textattack/albert-base-v2-imdb eval](<docs/models/textattack/albert-base-v2-imdb eval>)           | ✘             | 782 (22)                        | N/A                             | N/A                  |                  2228.19 | N/A                      | N/A            |
| [tf_efficientnet_lite0.in1k eval](<docs/models/tf_efficientnet_lite0.in1k eval>)                   | ✘             | 149 (9)                         | N/A                             | N/A                  |                   984.34 | N/A                      | N/A            |
| [tf_efficientnet_lite1.in1k eval](<docs/models/tf_efficientnet_lite1.in1k eval>)                   | ✘             | 194 (9)                         | N/A                             | N/A                  |                   833.14 | N/A                      | N/A            |
| [tf_efficientnet_lite2.in1k eval](<docs/models/tf_efficientnet_lite2.in1k eval>)                   | ✘             | 194 (9)                         | N/A                             | N/A                  |                  1216.69 | N/A                      | N/A            |
| [tf_efficientnet_lite3.in1k eval](<docs/models/tf_efficientnet_lite3.in1k eval>)                   | ✘             | 221 (9)                         | N/A                             | N/A                  |                   961.15 | N/A                      | N/A            |
| [tf_efficientnet_lite4.in1k eval](<docs/models/tf_efficientnet_lite4.in1k eval>)                   | ✘             | 275 (9)                         | N/A                             | N/A                  |                  1146.45 | N/A                      | N/A            |
| [twmkn9/albert-base-v2-squad2 eval](<docs/models/twmkn9/albert-base-v2-squad2 eval>)               | ✘             | 783 (23)                        | N/A                             | N/A                  |                  2565.4  | N/A                      | N/A            |
| [vgg11 eval](<docs/models/vgg11 eval>)                                                             | ✘             | 33 (8)                          | N/A                             | N/A                  |                  1706.96 | N/A                      | N/A            |
| [vgg11_bn eval](<docs/models/vgg11_bn eval>)                                                       | ✘             | 41 (9)                          | N/A                             | N/A                  |                  1746.85 | N/A                      | N/A            |
| [vgg13 eval](<docs/models/vgg13 eval>)                                                             | ✘             | 37 (8)                          | N/A                             | N/A                  |                  1729.07 | N/A                      | N/A            |
| [vgg13_bn eval](<docs/models/vgg13_bn eval>)                                                       | ✘             | 47 (9)                          | N/A                             | N/A                  |                  1792.09 | N/A                      | N/A            |
| [vgg16 eval](<docs/models/vgg16 eval>)                                                             | ✘             | 43 (8)                          | N/A                             | N/A                  |                  1893.79 | N/A                      | N/A            |
| [vgg16_bn eval](<docs/models/vgg16_bn eval>)                                                       | ✘             | 56 (9)                          | N/A                             | N/A                  |                  1822.35 | N/A                      | N/A            |
| [vgg19 eval](<docs/models/vgg19 eval>)                                                             | ✘             | 49 (8)                          | N/A                             | N/A                  |                  1948.51 | N/A                      | N/A            |
| [vgg19_bn eval](<docs/models/vgg19_bn eval>)                                                       | ✘             | 65 (9)                          | N/A                             | N/A                  |                  2081.05 | N/A                      | N/A            |
| [vit_b_16 eval](<docs/models/vit_b_16 eval>)                                                       | ✘             | 552 (17)                        | N/A                             | N/A                  |                  1850.14 | N/A                      | N/A            |
| [vit_b_32 eval](<docs/models/vit_b_32 eval>)                                                       | ✘             | 552 (17)                        | N/A                             | N/A                  |                  1684.36 | N/A                      | N/A            |
| [vit_h_14 eval](<docs/models/vit_h_14 eval>)                                                       | ✘             | 1452 (17)                       | N/A                             | N/A                  |                 15818.6  | N/A                      | N/A            |
| [vit_l_16 eval](<docs/models/vit_l_16 eval>)                                                       | ✘             | 1092 (17)                       | N/A                             | N/A                  |                  5671.5  | N/A                      | N/A            |
| [vit_l_32 eval](<docs/models/vit_l_32 eval>)                                                       | ✘             | 1092 (17)                       | N/A                             | N/A                  |                  5359.04 | N/A                      | N/A            |
| [wide_resnet101_2 eval](<docs/models/wide_resnet101_2 eval>)                                       | ✘             | 346 (9)                         | N/A                             | N/A                  |                  2571.18 | N/A                      | N/A            |
| [wide_resnet50_2 eval](<docs/models/wide_resnet50_2 eval>)                                         | ✘             | 176 (9)                         | N/A                             | N/A                  |                  1492.67 | N/A                      | N/A            |
| [xception71.tf_in1k eval](<docs/models/xception71.tf_in1k eval>)                                   | ✘             | 393 (9)                         | N/A                             | N/A                  |                  2504.06 | N/A                      | N/A            |

### Explanation of Metrics

**Model**: Name of the model.  
**Run Success**: Indicates whether the model runs successfully after conversion.  
**Torch Ops Before (Unique Ops)**: The total number of operations used by the model in the original Torch implementation. The number in parenthesis represents the total unique ops.  
**Torch Ops Remain (Unique Ops)**: The total number of operations used after conversion to TTNN. The number in parenthesis represents the total unique ops.  
**To/From Device Ops**: The number of `to/from_device` operations (data transfer to/from the device).  
**Original Run Time (ms)**: Execution time (in seconds) of the model before conversion.  
**Compiled Run Time (ms)**: Execution time (in seconds) of the model after conversion.  
**Accuracy (%)**: Model accuracy on a predefined test dataset after conversion.  

***

## Quickstart

The `torch_ttnn` module has a `backend` function, which can be used with the `torch.compile()`.

```python
import torch
import torch_ttnn

# A torch Module
class FooModule(torch.nn.Module):
    ...
# Create a module
module = FooModule()

# Compile the module, with ttnn backend
device = ttnn.open_device(device_id=0)
option = torch_ttnn.TorchTtnnOption(device=self.device)
ttnn_module = torch.compile(module, backend=torch_ttnn.backend, options=option)

# Running inference / training
ttnn_module(input_data)
```

## Tracer
The tracer dump the information of fx graph such as node's op_name and shape.

For example, you can run this script to parse the information
```
PYTHONPATH=$(pwd) python3 tools/stat_models.py --trace_orig --backward --profile
ls stat/raw
```

By default, the raw result will be stored at `stat/raw`, and you can run this script to generate the report
```
python3 tools/generate_report.py
ls stat/
```
Now the `stat/` folder have these report
 - `fw_node_count.csv`
 - `bw_node_count.csv`
 - `fw_total_input_size_dist/`
 - `bw_total_input_size_dist/`
 - `fw_total_output_size_dist/`
 - `bw_total_output_size_dist/`
 - `profile/`

The `node_count.csv` show the node with `op_type` appear in the fx graph. This report can help analyze the frequency of op type appear in the graph.

The `*_total_*_size_dist/` statistics the `op_type`'s input/output_size distribution from all fx graph recored in `stat/raw`. This report can help analyze the memory footprint durning the calculation of `op_type`.

 - Notice: the default `input_shapes` in `tools/stat_torchvision.py` is `[1,3,224,224]`, which has dependency with `*_total_*_size_dist/` report.

 - Notice: the [aten ir interface is in there](https://pytorch.org/docs/stable/torch.compiler_ir.html)

[The `profile/` is the tools provided by pytorch](https://pytorch.org/tutorials/recipes/recipes/profiler_recipe.html), you can open it by the url: chrome://tracing


# For developers

## Install torch-ttnn with editable mode

During development, you may want to use the torch-ttnn package for testing.
In order to do that, you can install the torch-ttnn package in "editable"
mode with

```shell
pip install -e .
```

Now, you can utilize `torch_ttnn` in your Python code. Any modifications you make to the `torch_ttnn` package will take effect immediately, eliminating the need for constant reinstallation via pip.

## Build wheel file

For developers want to deploy the wheel, you can build the wheel file with

```shell
python -m build
```

Then you can upload the `.whl` file to the PyPI (Python Package Index).

## Run transformer models
To run transformer model with ttnn backend, run:
```
PYTHONPATH="$TT_METAL_HOME:$(pwd)" python3 tools/run_transformers.py --model "phiyodr/bert-large-finetuned-squad2" --backend torch_ttnn
```

You can also substitute the backend with `torch_stat` to run a reference comparison.

# Add a model test
If you want to record run time metrics for a model or test, include a Pytest fixture named `record_property` as a parameter and set the "model_name" key.  
If you also want to compile the model with torch_ttnn backend, set the "torch_ttnn" key to a tuple in this order `(model, test_inputs, outputs)`. "model_name" still needs to be set. See the example code snippet below. `torch.nn.Module` models with `generate` method is supported.
```python
def Model(torch.nn.Module):
    def forward(self, x):
        # ...
        return outputs

# Add compilation_xfail marker if torch/CPU runs, but compiled version is xfail
@pytest.mark.compilation_xfail
# Add "record_property" parameter
def test_model_name(record_property):
    # Should be set as early as possible
    record_property("model_name", "Model Name")

    model = Model()
    # ...
    outputs = model(test_input)
    # outputs = model(**test_inputs) # dictionary inputs are also supported
    # ...

    # Can be set once all three objects for the tuple are defined
    record_property("torch_ttnn", (model, test_input(s), outputs))
```

If `model.generate(inputs)` is used, pass in `model.generate` instead of `model` to `record_property`.

